<!--
@license
Copyright (c) 2017 Vaadin Ltd.
This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
--><html><head><link rel="import" href="../polymer/polymer.html">
<link rel="import" href="iron-list.html">

<script>{var GridScrollerElement=function(_window$PolymerIronLi){var _Mathabs=Math.abs,_Mathmin=Math.min;babelHelpers.inherits(GridScrollerElement,_window$PolymerIronLi);function GridScrollerElement(){babelHelpers.classCallCheck(this,GridScrollerElement);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(GridScrollerElement).apply(this,arguments))}babelHelpers.createClass(GridScrollerElement,[{key:"_updateScrollerItem",value:function _updateScrollerItem(item,index){}},{key:"_afterScroll",value:function _afterScroll(){}},{key:"_getRowTarget",value:function _getRowTarget(){}},{key:"_createScrollerRows",value:function _createScrollerRows(){}},{key:"_canPopulate",value:function _canPopulate(){}},{key:"scrollToIndex",value:function scrollToIndex(index){var _this=this;this._warnPrivateAPIAccess("scrollToIndex");if(0<index){this._pendingScrollToIndex=null}if(!parseInt(this.$.items.style.borderTopWidth)&&0<index){this._pendingScrollToIndex=index}this._scrollingToIndex=!0;index=_Mathmin(Math.max(index,0),this._effectiveSize-1);this.$.table.scrollTop=index/this._effectiveSize*(this.$.table.scrollHeight-this.$.table.offsetHeight);this._scrollHandler();if(this._accessIronListAPI(function(){return _this._maxScrollTop})&&this._virtualCount<this._effectiveSize){this._adjustVirtualIndexOffset(1e6)}this._accessIronListAPI(function(){return babelHelpers.get(babelHelpers.getPrototypeOf(GridScrollerElement.prototype),"scrollToIndex",_this).call(_this,index-_this._vidxOffset)});this._scrollHandler();var row=Array.from(this.$.items.children).filter(function(child){return child.index===index})[0];if(row){var headerOffset=row.getBoundingClientRect().top-this.$.header.getBoundingClientRect().bottom;if(1<_Mathabs(headerOffset)){this.$.table.scrollTop+=headerOffset;this._scrollHandler()}}this._scrollingToIndex=!1}},{key:"_effectiveSizeChanged",value:function _effectiveSizeChanged(size){var _this2=this,fvi,fviOffset=0;this._iterateItems(function(pidx,vidx){if(vidx===_this2._firstVisibleIndex){var row=_this2._physicalItems[pidx];fvi=row.index;fviOffset=row.getBoundingClientRect().top}});if(this.items&&size<this.items.length){this._scrollTop=0}if(!Array.isArray(this.items)){var maxVirtualItems=this._edge||this._ie?3e4:1e5;this.items={length:_Mathmin(size,maxVirtualItems)}}this._accessIronListAPI(function(){return babelHelpers.get(babelHelpers.getPrototypeOf(GridScrollerElement.prototype),"_itemsChanged",_this2).call(_this2,{path:"items"})});this._virtualCount=_Mathmin(this.items.length,size)||0;if(0===this._scrollTop){this._accessIronListAPI(function(){return _this2._scrollToIndex(_Mathmin(size-1,fvi))});this._iterateItems(function(pidx,vidx){var row=_this2._physicalItems[pidx];if(row.index===fvi){_this2.$.table.scrollTop+=row.getBoundingClientRect().top-fviOffset}if(row.index===_this2._focusedItemIndex&&_this2._itemsFocusable&&_this2.$.items.contains(_this2.shadowRoot.activeElement)){var cellIndex=Array.from(_this2._itemsFocusable.parentElement.children).indexOf(_this2._itemsFocusable);row.children[cellIndex].focus()}})}this._assignModels()}},{key:"_positionItems",value:function _positionItems(){var _this3=this;this._adjustScrollPosition();var rePosition;if(isNaN(this._physicalTop)){rePosition=!0;this._physicalTop=0}var y=this._physicalTop;this._iterateItems(function(pidx,vidx){_this3._physicalItems[pidx].style.transform="translateY(".concat(y,"px)");y+=_this3._physicalSizes[pidx]});if(rePosition){this._scrollToIndex(0)}}},{key:"_increasePoolIfNeeded",value:function _increasePoolIfNeeded(count){var _this4=this;if(0===count&&this._scrollingToIndex||!this._canPopulate()){return}if(0===this._physicalCount){this._updateMetrics();babelHelpers.get(babelHelpers.getPrototypeOf(GridScrollerElement.prototype),"_increasePoolIfNeeded",this).call(this,25)}else{var viewportCovered=this._physicalCount*this._physicalAverage>=3*this._viewportHeight;if(!viewportCovered){this._accessIronListAPI(function(){return babelHelpers.get(babelHelpers.getPrototypeOf(GridScrollerElement.prototype),"_increasePoolIfNeeded",_this4).call(_this4,count)})}}}},{key:"_createPool",value:function _createPool(size){var _this5=this,fragment=document.createDocumentFragment(),physicalItems=this._createScrollerRows(size);physicalItems.forEach(function(inst){return fragment.appendChild(inst)});this._getRowTarget().appendChild(fragment);var content=this.querySelector("[slot]");if(content){var slot=content.getAttribute("slot");content.setAttribute("slot","foo-bar");content.setAttribute("slot",slot)}this._updateHeaderFooterMetrics();Polymer.RenderStatus.afterNextRender(this,function(){return _this5.notifyResize()});return physicalItems}},{key:"_assignModels",value:function _assignModels(itemSet){var _this6=this;this._iterateItems(function(pidx,vidx){var el=_this6._physicalItems[pidx];_this6._toggleAttribute("hidden",vidx>=_this6._effectiveSize,el);_this6._updateScrollerItem(el,vidx+(_this6._vidxOffset||0))},itemSet)}},{key:"_scrollHandler",value:function _scrollHandler(){var _this7=this,delta=this.$.table.scrollTop-this._scrollPosition;this._accessIronListAPI(babelHelpers.get(babelHelpers.getPrototypeOf(GridScrollerElement.prototype),"_scrollHandler",this));var oldOffset=this._vidxOffset;if(this._accessIronListAPI(function(){return _this7._maxScrollTop})&&this._virtualCount<this._effectiveSize){this._adjustVirtualIndexOffset(delta)}if(this._vidxOffset!==oldOffset){this._update()}this._afterScroll()}},{key:"_adjustVirtualIndexOffset",value:function _adjustVirtualIndexOffset(delta){if(1e4<_Mathabs(delta)){if(this._noScale){this._noScale=!1;return}var scale=this.$.table.scrollTop/(this.$.table.scrollHeight-this.$.table.offsetHeight),offset=scale*this._effectiveSize;this._vidxOffset=Math.round(offset-scale*this._virtualCount)}else{var oldOffset=this._vidxOffset||0,threshold=1e3,maxShift=100;if(0===this._scrollTop){this._vidxOffset=0;if(oldOffset!==this._vidxOffset){babelHelpers.get(babelHelpers.getPrototypeOf(GridScrollerElement.prototype),"scrollToIndex",this).call(this,0)}}else if(this.firstVisibleIndex<threshold&&0<this._vidxOffset){this._vidxOffset-=_Mathmin(this._vidxOffset,maxShift);if(oldOffset!==this._vidxOffset){babelHelpers.get(babelHelpers.getPrototypeOf(GridScrollerElement.prototype),"scrollToIndex",this).call(this,this.firstVisibleIndex+(oldOffset-this._vidxOffset))}this._noScale=!0}var maxOffset=this._effectiveSize-this._virtualCount;if(this._scrollTop>=this._maxScrollTop&&0<this._maxScrollTop){this._vidxOffset=maxOffset;if(oldOffset!==this._vidxOffset){babelHelpers.get(babelHelpers.getPrototypeOf(GridScrollerElement.prototype),"scrollToIndex",this).call(this,this._virtualCount)}}else if(this.firstVisibleIndex>this._virtualCount-threshold&&this._vidxOffset<maxOffset){this._vidxOffset+=_Mathmin(maxOffset-this._vidxOffset,maxShift);if(oldOffset!==this._vidxOffset){babelHelpers.get(babelHelpers.getPrototypeOf(GridScrollerElement.prototype),"scrollToIndex",this).call(this,this.firstVisibleIndex-(this._vidxOffset-oldOffset))}this._noScale=!0}}}},{key:"_accessIronListAPI",value:function _accessIronListAPI(cb){var _this8=this;this._warnPrivateAPIAccessAsyncEnabled=!1;this._debouncerWarnPrivateAPIAccess=Polymer.Debouncer.debounce(this._debouncerWarnPrivateAPIAccess,Polymer.Async.animationFrame,function(){return _this8._warnPrivateAPIAccessAsyncEnabled=!0});return cb.apply(this)}},{key:"_debounceRender",value:function _debounceRender(cb,asyncModule){var _this9=this;babelHelpers.get(babelHelpers.getPrototypeOf(GridScrollerElement.prototype),"_debounceRender",this).call(this,function(){return _this9._accessIronListAPI(cb)},asyncModule)}},{key:"_warnPrivateAPIAccess",value:function _warnPrivateAPIAccess(apiName){if(this._warnPrivateAPIAccessAsyncEnabled){console.warn("Accessing private API (".concat(apiName,")!"))}}},{key:"_render",value:function _render(){this._accessIronListAPI(babelHelpers.get(babelHelpers.getPrototypeOf(GridScrollerElement.prototype),"_render",this))}},{key:"_createFocusBackfillItem",value:function _createFocusBackfillItem(){}},{key:"_multiSelectionChanged",value:function _multiSelectionChanged(){}},{key:"clearSelection",value:function clearSelection(){}},{key:"_itemsChanged",value:function _itemsChanged(){}},{key:"_manageFocus",value:function _manageFocus(){}},{key:"_removeFocusedItem",value:function _removeFocusedItem(){}},{key:"_scrollToIndex",value:function _scrollToIndex(index){var _this10=this;this._accessIronListAPI(function(){return _this10.scrollToIndex(index)})}},{key:"updateViewportBoundaries",value:function updateViewportBoundaries(){this._warnPrivateAPIAccess("updateViewportBoundaries");babelHelpers.get(babelHelpers.getPrototypeOf(GridScrollerElement.prototype),"updateViewportBoundaries",this).apply(this,arguments)}},{key:"_firstVisibleIndex",get:function get(){var _this11=this;return this._accessIronListAPI(function(){return babelHelpers.get(babelHelpers.getPrototypeOf(GridScrollerElement.prototype),"firstVisibleIndex",_this11)})}},{key:"_lastVisibleIndex",get:function get(){var _this12=this;return this._accessIronListAPI(function(){return babelHelpers.get(babelHelpers.getPrototypeOf(GridScrollerElement.prototype),"lastVisibleIndex",_this12)})}},{key:"firstVisibleIndex",get:function get(){this._warnPrivateAPIAccess("firstVisibleIndex");return babelHelpers.get(babelHelpers.getPrototypeOf(GridScrollerElement.prototype),"firstVisibleIndex",this)},set:function set(value){this._warnPrivateAPIAccess("firstVisibleIndex");babelHelpers.set(babelHelpers.getPrototypeOf(GridScrollerElement.prototype),"firstVisibleIndex",value,this,!0)}},{key:"lastVisibleIndex",get:function get(){this._warnPrivateAPIAccess("lastVisibleIndex");return babelHelpers.get(babelHelpers.getPrototypeOf(GridScrollerElement.prototype),"lastVisibleIndex",this)},set:function set(value){this._warnPrivateAPIAccess("lastVisibleIndex");babelHelpers.set(babelHelpers.getPrototypeOf(GridScrollerElement.prototype),"lastVisibleIndex",value,this,!0)}},{key:"maxPhysicalCount",get:function get(){this._warnPrivateAPIAccess("maxPhysicalCount");return babelHelpers.get(babelHelpers.getPrototypeOf(GridScrollerElement.prototype),"maxPhysicalCount",this)},set:function set(value){this._warnPrivateAPIAccess("maxPhysicalCount");babelHelpers.set(babelHelpers.getPrototypeOf(GridScrollerElement.prototype),"maxPhysicalCount",value,this,!0)}},{key:"scrollOffset",get:function get(){this._warnPrivateAPIAccess("scrollOffset");return babelHelpers.get(babelHelpers.getPrototypeOf(GridScrollerElement.prototype),"scrollOffset",this)},set:function set(value){this._warnPrivateAPIAccess("scrollOffset");babelHelpers.set(babelHelpers.getPrototypeOf(GridScrollerElement.prototype),"scrollOffset",value,this,!0)}}],[{key:"is",get:function get(){return"vaadin-grid-scroller"}},{key:"properties",get:function get(){return{size:Number,_vidxOffset:{value:0}}}},{key:"observers",get:function get(){return["_effectiveSizeChanged(_effectiveSize)"]}}]);return GridScrollerElement}(window.PolymerIronList);customElements.define(GridScrollerElement.is,GridScrollerElement);window.Vaadin=window.Vaadin||{};window.Vaadin.Grid=window.Vaadin.Grid||{};Vaadin.Grid.ScrollerElement=GridScrollerElement}</script>
</head><body></body></html>