<!--
@license
Copyright (c) 2017 Vaadin Ltd.
This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
--><html><head><link rel="import" href="../polymer/polymer.html">
<link rel="import" href="vaadin-grid-column.html">
<link rel="import" href="../vaadin-checkbox/vaadin-checkbox.html">

</head><body><dom-module id="vaadin-grid-selection-column">
  <template>
    <template class="header" id="defaultHeaderTemplate">
      <vaadin-checkbox class="vaadin-grid-select-all-checkbox" aria-label="Select All" hidden$="[[_selectAllHidden]]" on-checked-changed="_onSelectAllCheckedChanged" checked="[[_isChecked(selectAll, _indeterminate)]]" indeterminate="[[_indeterminate]]">
      </vaadin-checkbox>
    </template>
    <template id="defaultBodyTemplate">
      <vaadin-checkbox aria-label="Select Row" checked="{{selected}}">
      </vaadin-checkbox>
    </template>
  </template>

  <script>{var GridSelectionColumnElement=function(_Vaadin$GridColumnEle){babelHelpers.inherits(GridSelectionColumnElement,_Vaadin$GridColumnEle);babelHelpers.createClass(GridSelectionColumnElement,[{key:"_prepareHeaderTemplate",value:function _prepareHeaderTemplate(){var headerTemplate=this._prepareTemplatizer(this._findTemplate("template.header")||this.$.defaultHeaderTemplate);headerTemplate.templatizer.dataHost=headerTemplate===this.$.defaultHeaderTemplate?this:this.dataHost;return headerTemplate}},{key:"_prepareBodyTemplate",value:function _prepareBodyTemplate(){var template=this._prepareTemplatizer(this._findTemplate("template:not(.header):not(.footer)")||this.$.defaultBodyTemplate);template.templatizer.dataHost=template===this.$.defaultBodyTemplate?this:this.dataHost;return template}}],[{key:"is",get:function get(){return"vaadin-grid-selection-column"}},{key:"properties",get:function get(){return{width:{type:String,value:"56px"},flexGrow:{type:Number,value:0},selectAll:{type:Boolean,value:!1,notify:!0},autoSelect:{type:Boolean,value:!1},headerTemplate:Object,template:Object,_indeterminate:Boolean,_previousActiveItem:Object,_selectAllHidden:Boolean}}},{key:"observers",get:function get(){return["_onSelectAllChanged(selectAll)"]}}]);function GridSelectionColumnElement(){var _this;babelHelpers.classCallCheck(this,GridSelectionColumnElement);_this=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(GridSelectionColumnElement).call(this));_this._boundOnActiveItemChanged=_this._onActiveItemChanged.bind(babelHelpers.assertThisInitialized(babelHelpers.assertThisInitialized(_this)));_this._boundOnDataProviderChanged=_this._onDataProviderChanged.bind(babelHelpers.assertThisInitialized(babelHelpers.assertThisInitialized(_this)));_this._boundOnSelectedItemsChanged=_this._onSelectedItemsChanged.bind(babelHelpers.assertThisInitialized(babelHelpers.assertThisInitialized(_this)));return _this}babelHelpers.createClass(GridSelectionColumnElement,[{key:"disconnectedCallback",value:function disconnectedCallback(){babelHelpers.get(babelHelpers.getPrototypeOf(GridSelectionColumnElement.prototype),"disconnectedCallback",this).call(this);if(this._grid){this._grid.removeEventListener("active-item-changed",this._boundOnActiveItemChanged);this._grid.removeEventListener("data-provider-changed",this._boundOnDataProviderChanged);this._grid.removeEventListener("filter-changed",this._boundOnSelectedItemsChanged);this._grid.removeEventListener("selected-items-changed",this._boundOnSelectedItemsChanged);var isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);if(isSafari&&window.ShadyDOM&&this.parentElement){var parent=this.parentElement,nextSibling=this.nextElementSibling;parent.removeChild(this);if(nextSibling){parent.insertBefore(this,nextSibling)}else{parent.appendChild(this)}}}}},{key:"connectedCallback",value:function connectedCallback(){babelHelpers.get(babelHelpers.getPrototypeOf(GridSelectionColumnElement.prototype),"connectedCallback",this).call(this);if(this._grid){this._grid.addEventListener("active-item-changed",this._boundOnActiveItemChanged);this._grid.addEventListener("data-provider-changed",this._boundOnDataProviderChanged);this._grid.addEventListener("filter-changed",this._boundOnSelectedItemsChanged);this._grid.addEventListener("selected-items-changed",this._boundOnSelectedItemsChanged)}}},{key:"_onSelectAllChanged",value:function _onSelectAllChanged(selectAll){if(selectAll===void 0||!this._grid){return}if(this._selectAllChangeLock){return}this._grid.selectedItems=selectAll&&Array.isArray(this._grid.items)?this._grid._filter(this._grid.items):[]}},{key:"_arrayContains",value:function _arrayContains(a,b){for(var i=0;a&&b&&b[i]&&0<=a.indexOf(b[i]);i++){;}return i==b.length}},{key:"_onSelectAllCheckedChanged",value:function _onSelectAllCheckedChanged(e){this.selectAll=this._indeterminate||e.target.checked}},{key:"_isChecked",value:function _isChecked(selectAll,indeterminate){return indeterminate||selectAll}},{key:"_onActiveItemChanged",value:function _onActiveItemChanged(e){var activeItem=e.detail.value;if(this.autoSelect){var item=activeItem||this._previousActiveItem;if(item){this._grid._toggleItem(item)}}this._previousActiveItem=activeItem}},{key:"_onSelectedItemsChanged",value:function _onSelectedItemsChanged(e){this._selectAllChangeLock=!0;if(Array.isArray(this._grid.items)){if(!this._grid.selectedItems.length){this.selectAll=!1;this._indeterminate=!1}else if(this._arrayContains(this._grid.selectedItems,this._grid._filter(this._grid.items))){this.selectAll=!0;this._indeterminate=!1}else{this.selectAll=!1;this._indeterminate=!0}}this._selectAllChangeLock=!1}},{key:"_onDataProviderChanged",value:function _onDataProviderChanged(e){this._selectAllHidden=!Array.isArray(this._grid.items)}}]);return GridSelectionColumnElement}(Vaadin.GridColumnElement);customElements.define(GridSelectionColumnElement.is,GridSelectionColumnElement);window.Vaadin=window.Vaadin||{};Vaadin.GridSelectionColumnElement=GridSelectionColumnElement}</script>
</dom-module>
</body></html>