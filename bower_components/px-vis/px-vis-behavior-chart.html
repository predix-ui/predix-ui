<!--
Copyright (c) 2018, General Electric

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
--><html><head><link rel="import" href="px-vis-behavior-common.html">
<link rel="import" href="px-vis-behavior-d3.html">
<link rel="import" href="px-vis-behavior-datetime.html">
<link rel="import" href="../iron-resizable-behavior/iron-resizable-behavior.html">
<script>var _properties,PxVisBehaviorChart=window.PxVisBehaviorChart=window.PxVisBehaviorChart||{};PxVisBehaviorChart.searchToolbar={getToolbar:function getToolbar(){return this.$$("px-vis-toolbar")}};PxVisBehaviorChart.chartCommonMethods=[{_returnAllKeys:function _returnAllKeys(d){for(var o={},k,i=0;i<d.length;i++){k=Object.keys(d[i]);for(var j=0;j<k.length;j++){o[k[j]]=!0}}return Object.keys(o)}},PxColorsBehavior.getSeriesColors,PxVisBehaviorChart.searchToolbar];PxVisBehaviorChart.chartCommon=[{properties:{seriesConfig:{type:Object,value:function value(){return{}}},_defaultSeriesConfig:{type:Object,value:function value(){return{type:"line",x:"x",axis:{id:"defaultAxis",side:"left",number:1}}}},defaultSeriesConfig:{type:Object,value:function value(){return{}},observer:"_updateDSC"},includeAllSeries:{type:Boolean,value:!1},_seriesKeys:{type:Array},preventCompleteSeriesConfigCalc:{type:Boolean,value:!1}},observers:["_setCompleteSeriesConfig(_defaultSeriesConfig.*,chartData.*,seriesConfig.*,seriesColorList.*)"],_calcChartExts:function _calcChartExts(mins,maxes,axis){if(this._isOrdinalType(this[axis+"AxisType"])){return[]}mins.push(1/0);maxes.push(-Infinity);return[Math.min.apply(null,mins),Math.max.apply(null,maxes)]},_setCompleteSeriesConfig:function _setCompleteSeriesConfig(){if(this.hasUndefinedArguments(arguments)){return}if(this._doesObjHaveValues(this._defaultSeriesConfig)&&this._doesObjHaveValues(this.chartData)&&this._doesObjHaveValues(this.seriesColorList)&&!this.preventCompleteSeriesConfigCalc){for(var fullConfig=this.seriesConfig?this.clone(this.seriesConfig):{},k=Object.keys(fullConfig),kLen=k.length,allYs=this.includeAllSeries?this._returnAllKeys(this.chartData):[],objYs=allYs.reduce(function(obj,item){obj[item]={};return obj},{}),defaultConfigProps=Object.keys(this._defaultSeriesConfig),xMins=[],xMaxes=[],yMins=[],yMaxes=[],missingYs,x,isUpdate=this.completeSeriesConfig?!0:!1,addedSeriesKeys=[],removedSeriesKeys=[],updatedSeriesKeys=[],extsObj={},skipProperties=["xMin","xMax","yMin","yMax"],i=0;i<kLen;i++){if(!fullConfig[k[i]].hasOwnProperty("y")){console.warn("(\u273F\u25E0\u203F\u25E0) Configuration "+k[i]+" does not have a y-value associated with it. Falling back to ID (\u273F\u25E0\u203F\u25E0)");fullConfig[k[i]].y=k[i]}if(!fullConfig[k[i]].hasOwnProperty("x")){if(!this.defaultSeriesConfig.x){console.warn("(\uFF61\u25D5\u203F\u25D5\uFF61) Configuration "+k[i]+" does not have a x-value associated with it. Falling back to default (\uFF61\u25D5\u203F\u25D5\uFF61)")}fullConfig[k[i]].x=this._defaultSeriesConfig.x}if(!fullConfig[k[i]].name){fullConfig[k[i]].name=k[i]}if(!fullConfig[k[i]].color&&!this._dontCalcColors){fullConfig[k[i]].color=this._getColor(i)}for(var j=0,property;j<defaultConfigProps.length;j++){property=defaultConfigProps[j];if("undefined"===typeof fullConfig[k[i]][property]&&"undefined"!==typeof this._defaultSeriesConfig[property]&&-1===skipProperties.indexOf(property)){fullConfig[k[i]][property]=this._defaultSeriesConfig[property]}}if(fullConfig[k[i]].xMin){xMins.push(fullConfig[k[i]].xMin)}if(fullConfig[k[i]].xMax){xMaxes.push(fullConfig[k[i]].xMax)}if(fullConfig[k[i]].yMin){yMins.push(fullConfig[k[i]].yMin)}if(fullConfig[k[i]].yMax){yMaxes.push(fullConfig[k[i]].yMax)}delete objYs[fullConfig[k[i]].y]}if(this.includeAllSeries){x=this.defaultSeriesConfig.x?this.defaultSeriesConfig.x:this._defaultSeriesConfig.x}else{x=0<k.length?fullConfig[k[0]].x:this._defaultSeriesConfig.x}delete objYs[x];missingYs=Object.keys(objYs);for(var i=0;i<missingYs.length;i++){objYs[missingYs[i]]=JSON.parse(JSON.stringify(this._defaultSeriesConfig));objYs[missingYs[i]].name=missingYs[i];objYs[missingYs[i]].x=x;objYs[missingYs[i]].y=missingYs[i];if(!this._dontCalcColors){objYs[missingYs[i]].color=this._getColor(kLen+i)}fullConfig[missingYs[i]]=objYs[missingYs[i]]}if(this.range){var min=+Px.moment(this.range.from,Px.moment.ISO_8601).format("x"),max=+Px.moment(this.range.to,Px.moment.ISO_8601).format("x");extsObj.x=[min,max]}if(!extsObj.x){extsObj.x=this._calcChartExts(xMins,xMaxes,"x")}if(!extsObj.y){extsObj.y=this._calcChartExts(yMins,yMaxes,"y")}var deletion=!1,addition=!1,mutedKeys=[];if(isUpdate){for(var currKeys=Object.keys(this.completeSeriesConfig),newKeys=Object.keys(fullConfig),i=0;i<newKeys.length;i++){if(currKeys.includes(newKeys[i])){updatedSeriesKeys.push(newKeys[i])}else{addedSeriesKeys.push(newKeys[i]);addition=!0}}for(var i=0;i<currKeys.length;i++){if(!newKeys.includes(currKeys[i])){removedSeriesKeys.push(currKeys[i]);deletion=!0}}}if(deletion){if(this.mutedSeries){for(var i=0;i<removedSeriesKeys.length;i++){if(this.mutedSeries[removedSeriesKeys[i]]){this.muteUnmuteSeries(removedSeriesKeys[i]);mutedKeys.push(removedSeriesKeys[i])}else if("boolean"===typeof this.mutedSeries[removedSeriesKeys[i]]){mutedKeys.push(removedSeriesKeys[i])}}}this.set("_seriesKeys",updatedSeriesKeys);Polymer.dom.flush();if(0<mutedKeys.length){for(var i=0;i<mutedKeys.length;i++){delete this.mutedSeries[mutedKeys[i]]}}}else{this.set("_seriesKeys",Object.keys(fullConfig))}this.fire("px-vis-data-extents",{dataVar:"dataExtents",data:extsObj,method:"set"});this.set("dataExtents",extsObj);this.fire("px-vis-complete-series-config",{dataVar:"completeSeriesConfig",data:fullConfig,method:"set"});this.set("completeSeriesConfig",fullConfig);if(deletion&&addition){this.set("_seriesKeys",Object.keys(fullConfig))}}else if(this.chartData&&0===this.chartData.length){this.set("_seriesKeys",[]);Polymer.dom.flush()}},_sideRegister:function _sideRegister(location){return"side"===location||"both"===location},_topRegister:function _topRegister(location){return"top"===location||"both"===location},_chartTypeLine:function _chartTypeLine(key,obj){if(this.hasUndefinedArguments(arguments)){return}return obj&&obj[key]&&("line"===obj[key].type||"both"===obj[key].type)},_chartTypeScatter:function _chartTypeScatter(key,obj){if(this.hasUndefinedArguments(arguments)){return}return obj&&obj[key]&&("scatter"===obj[key].type||"both"===obj[key].type)},_returnKeys:function _returnKeys(obj){return Object.keys(obj)},_updateDSC:function _updateDSC(dsc){if(dsc===void 0){return}for(var k=Object.keys(this.defaultSeriesConfig),val,i=0;i<k.length;i++){val=this.defaultSeriesConfig[k[i]];this._defaultSeriesConfig[k[i]]=val}this.notifyPath("_defaultSeriesConfig")}},PxVisBehavior.observerCheck,PxColorsBehavior.dataVisColors,PxVisBehaviorChart.chartCommonMethods,PxVisBehavior.commonMethods,PxVisBehavior.completeSeriesConfig,PxVisBehavior.axisTypes,PxVisBehavior.muteUnmuteSeries,PxVisBehavior.scaleTypeCheck];PxVisBehaviorChart.chartId=[{properties:{chartId:{type:String}}},PxVisBehavior.uniqueIds];PxVisBehaviorChart.webWorkerSynchronization=[{properties:{_wwSyncRequestDataDeletion:{type:Boolean,value:!1},_wwSyncDataDeleted:{type:Boolean,value:!1},_wwSyncDataDeletionTimeout:{type:Number,value:1500},_wwSyncDataPropName:{type:String,value:"chartData"}},ready:function ready(){this.chartId=this.generateRandomID("chart")},attached:function attached(){if(!this.preventWebWorkerSynchronization){this._wwSyncRequestDataDeletion=!1;if(this.chartData&&this._wwSyncDataDeleted){this._keepDataInSync()}}},detached:function detached(){if(!this.preventWebWorkerSynchronization){this._wwSyncRequestDataDeletion=!0;window.setTimeout(function(){if(this._wwSyncRequestDataDeletion){Px.vis.scheduler.process({action:"unregisterChart",originatorName:this.nodeName,chartId:this.chartId,data:null});this._wwSyncDataDeleted=!0}}.bind(this),this._wwSyncDataDeletionTimeout)}},_keepDataInSync:function _keepDataInSync(){if(this.hasUndefinedArguments(arguments)){return}if(!this.preventWebWorkerSynchronization&&this[this._wwSyncDataPropName]){this._wwSyncDataDeleted=!1;Px.vis.scheduler.process({action:"updateData",originatorName:this.nodeName,chartId:this.chartId,data:{chartData:this[this._wwSyncDataPropName]}});this.set("wwDataSyncCounter",this.wwDataSyncCounter?this.wwDataSyncCounter+1:1)}}},PxVisBehavior.observerCheck,PxVisBehavior.dataset,PxVisBehavior.preventWebWorkerSynchronization,PxVisBehavior.wwDataSyncCounter];PxVisBehaviorChart.saveImage=[{getImage:function getImage(callback,renderLegend){var canvas=document.createElement("canvas"),context,result,svgData,elementsToRender=[],canvasKeys=Object.keys(this.canvasLayers),drawingWidth=this._extendedWidth?this._extendedWidth:this._smallerSide?this._smallerSide:this.width,drawingHeight=this._smallerSide?this._smallerSide:this.height;canvas.width=drawingWidth+(renderLegend?this._getRegisterWidth(drawingWidth,drawingHeight):0);canvas.height=drawingHeight;context=canvas.getContext("2d");elementsToRender.push([this.pxSvgElemLower,!0]);elementsToRender.push([this.canvasContext,!1]);for(var i=0;i<canvasKeys.length;i++){elementsToRender.push([this.canvasLayers[canvasKeys[i]],!1])}elementsToRender.push([this.pxSvgElem,!0]);var fn=function(){if(0<elementsToRender.length){var target=elementsToRender.shift();if(target[0]){if(!target[1]){var opacity=getComputedStyle(target[0].canvas).getPropertyValue("opacity"),context=canvas.getContext("2d"),oldAlpha=context.globalAlpha;context.globalAlpha=opacity;context.drawImage(target[0].canvas,0,0);context.globalAlpha=oldAlpha;if(0<elementsToRender.length){fn()}else{this._finishGetImage(callback,canvas,renderLegend,drawingWidth,drawingHeight)}fn()}else{this._drawSVGOnCanvas(canvas,target[0],function(resultCanvas){canvas=resultCanvas;if(0<elementsToRender.length){fn()}else{this._finishGetImage(callback,canvas,renderLegend,drawingWidth,drawingHeight)}}.bind(this))}}else{fn()}}}.bind(this);fn()},_finishGetImage:function _finishGetImage(callback,canvas,renderLegend,drawingWidth,drawingHeight){if(renderLegend){this._drawRegister(canvas.getContext("2d"),drawingWidth,drawingHeight)}callback({canvas:canvas,image:canvas.toDataURL()})},_getRegisterWidth:function _getRegisterWidth(drawingWidth,drawingHeight){if(this.completeSeriesConfig){var canvas=document.createElement("canvas");canvas.height=drawingHeight;canvas.width=9999;var curY=0,curX=drawingWidth+5,keys=Object.keys(this.completeSeriesConfig),maxWidth=0,maxTotalWidth=5,context=canvas.getContext("2d");curTextWidth=0;for(var i=0;i<keys.length;i++){curY+=30;curTextWidth=context.measureText(this.completeSeriesConfig[keys[i]].name).width;maxWidth=Math.max(maxWidth,curTextWidth);if(curY+30>drawingHeight){curX+=maxWidth+15;curY=0;maxTotalWidth+=maxWidth+15;maxWidth=0}}maxTotalWidth+=maxWidth+30;return maxTotalWidth}else{return 0}},_drawRegister:function _drawRegister(context,startWidth,drawingHeight){if(this.completeSeriesConfig){for(var curY=0,lineLength=25,strokeWidth=3,curX=startWidth+5,keys=Object.keys(this.completeSeriesConfig),maxWidth=0,curTextWidth=0,i=0;i<keys.length;i++){curY+=30;context.fillStyle=this.completeSeriesConfig[keys[i]].color;context.fillRect(curX,curY,strokeWidth,lineLength);context.fillStyle=this._checkThemeVariable("--px-vis-register-data-value","rgb(0,0,0)");context.fillText(this.completeSeriesConfig[keys[i]].name,curX+strokeWidth+5,curY+10);curTextWidth=context.measureText(this.completeSeriesConfig[keys[i]].name).width;maxWidth=Math.max(maxWidth,curTextWidth);if(curY+30>drawingHeight){curX+=maxWidth+15;curY=0}}}}},PxVisBehavior.completeSeriesConfig];PxVisBehaviorChart.chartAutoResize=[{properties:{preventResize:{type:Boolean,value:!1,observer:"_preventResizeChanged"},chartHorizontalAlignment:{type:String,value:"center"},chartVerticalAlignment:{type:String,value:"center"},_chartWrapperClass:{type:String,computed:"_getChartWrapperClass(chartHorizontalAlignment, chartVerticalAlignment)"},debounceResizeTiming:{type:Number,value:250}},listeners:{"iron-resize":"_onIronResize"},_preventResizeChanged:function _preventResizeChanged(){if(this.hasUndefinedArguments(arguments)){return}if(!this.preventResize){this.notifyResize()}},_getChartWrapperClass:function _getChartWrapperClass(hor,vert){if(this.hasUndefinedArguments(arguments)){return}var base="flex wrapper ";if("center"===hor){base+="flex--center "}else if("right"===hor){base+="flex--right "}else{base+="flex--left "}if("center"===vert){base+="flex--middle"}else if("bottom"===vert){base+="flex--bottom"}else{base+="flex--top"}return base},_onIronResize:function _onIronResize(){var _this=this;if(this.preventResize){return}this.debounce("ironresize",function(){requestAnimationFrame(_this._resizeCalculations.bind(_this))},this.debounceResizeTiming)}},PxVisBehavior.observerCheck,Polymer.IronResizableBehavior];PxVisBehaviorChart.subConfiguration={properties:{},_applyConfigToElement:function _applyConfigToElement(config,element){if("string"===typeof config){config=JSON.parse(config)}if("object"!==babelHelpers.typeof(config)){console.error("Configuration object must be valid JSON: "+config);return}if(!element){console.error("Cannot apply config to undefined element");return}for(var keys=Object.keys(config),i=0,key;i<keys.length;i++){key=keys[i];element.set(key,config[key])}}};PxVisBehaviorChart.timeFiltering=[{properties:{timeData:{type:String,value:"Timestamp"},_filteredData:{type:Object,computed:"_filterData(chartData, timeDomain, timeData)"}},observers:["_setTimeKey(timeData)"],_setTimeKey:function _setTimeKey(){if(this.timeData){this.set("timeKey",this.timeData)}},_filterData:function _filterData(chartData,timeDomain,timeData){if(this.hasUndefinedArguments(arguments)){return}if(timeDomain.x&&2===timeDomain.x.length){var min=+timeDomain.x[0],max=+timeDomain.x[1];return chartData.filter(function(val){var timeVal=+val[timeData];if("undefined"===typeof val[timeData]){return val}else{return timeVal>=min&&timeVal<=max}})}else{return chartData}}},PxVisBehavior.observerCheck,PxVisBehavior.dataset,PxVisBehavior.timeDomain];PxVisBehaviorChart.waitForAttach={properties:{_loadedOnPage:{type:Boolean}},attached:function attached(){this._loadedOnPage=!0},_isLoadedOnPage:function _isLoadedOnPage(){var rect=this.getBoundingClientRect();if(0<rect.height&&0<rect.width){this.set("_loadedOnPage",!0)}else{this.async(this._isLoadedOnPage,50)}}};PxVisBehaviorChart.getHideClass=[{_getHideClass:function _getHideClass(hide){if(this.hasUndefinedArguments(arguments)){return}if(!0===hide){return"hideAxis"}return""}},PxVisBehavior.observerCheck];PxVisBehaviorChart.registerPositioning=[{properties:{hideRegister:{type:Boolean,value:!1,observer:"_hideRegisterChanged"},_registerType:{type:String},_registerWrapperClass:{type:String,computed:"_getRegisterWrapperClass(_registerType)"}},_getRegisterWrapperClass:function _getRegisterWrapperClass(){if(this.hasUndefinedArguments(arguments)){return}var classList="flex ";if(!this.hideRegister){if("vertical"===this._registerType){classList+="flex--row--rev"}else{classList+="flex--col"}}return classList},_hideRegisterChanged:function _hideRegisterChanged(){if(this.hasUndefinedArguments(arguments)){return}this.notifyResize()}},PxVisBehavior.observerCheck,PxVisBehaviorChart.getHideClass];PxVisBehaviorChart.registerConfigs={properties:{tooltipConfig:{type:Object},registerConfig:{type:Object}}};PxVisBehaviorChart.interactionSpaceConfig={properties:{interactionSpaceConfig:{type:Object,value:function value(){return{}}}}};PxVisBehaviorChart.chartToolbarConfig=[{properties:{toolbarConfig:{type:Object}}},PxVisBehaviorChart.interactionSpaceConfig];PxVisBehaviorChart.axisConfigs={properties:{xAxisConfig:{type:Object},yAxisConfig:{type:Object}}};PxVisBehaviorChart.navigatorConfig={properties:{navigatorConfig:{type:Object}}};PxVisBehaviorChart.highlighterConfigs={properties:{highlighterConfig:{type:Object}}};PxVisBehaviorChart.mouseCusorConfig={properties:{mouseCursorConfig:{type:Object}}};PxVisBehaviorChart.circleChart=[{properties:{_smallerSide:{type:Number,computed:"_computeSmallerSide(width, height)"},_diameter:{type:Number},_radius:{type:Number},_center:{type:Array},_internalCircleMargins:{type:Object,value:function value(){return{top:0,left:0,right:0,bottom:0}}}},observers:["_sizeChanged(_smallerSide, margin.*, _internalCircleMargins.*)"],_computeSmallerSide:function _computeSmallerSide(width,height){if(this.hasUndefinedArguments(arguments)){return}return Math.max(Math.min(height,width),0)},_sizeChanged:function _sizeChanged(_smallerSide,margin,internalMargin){var _Mathmax=Math.max;if(this.hasUndefinedArguments(arguments)){return}var ml=+this.margin.left+ +this._internalCircleMargins.left,mr=+this.margin.right+ +this._internalCircleMargins.right,mt=+this.margin.top+ +this._internalCircleMargins.top,mb=+this.margin.bottom+ +this._internalCircleMargins.bottom,adjWidth=_Mathmax(0,this._smallerSide-ml-mr),adjHeight=_Mathmax(0,this._smallerSide-mt-mb),diameter=Math.min(adjWidth,adjHeight),radius=diameter/2,center=[];center[0]=ml+adjWidth/2;center[1]=mt+adjHeight/2;if(this.polar&&this.zoomStack&&this.zoomStack.length){for(var originalRadius=this.zoomStack[0].radius,originalCenter=this.zoomStack[0].center,end=this.zoomStack.length-1,i=1;i<this.zoomStack.length;i++){var s=this.zoomStack[i].radius/originalRadius,r=s*radius,c0=this.zoomStack[i].center[0]/originalRadius*radius,c1=this.zoomStack[i].center[1]/originalRadius*radius;this.zoomStack[i].radius=r;this.zoomStack[i].center=[c0,c1]}this.zoomStack[0].radius=radius;this.zoomStack[0].center=center;radius=this.zoomStack[end].radius;center=this.zoomStack[end].center}this.set("_diameter",diameter);this.set("_radius",radius);this.set("_center",center)}},PxVisBehavior.observerCheck,PxVisBehavior.sizing];PxVisBehaviorChart.cursorConfig={properties:{cursorConfig:{type:Object}}};PxVisBehaviorChart.layers=[{properties:{layer:{type:Array,notify:!0},numberOfLayers:{type:Number},generateLayers:{type:Boolean,value:!0}},observers:["_createLayersOnce(svg, numberOfLayers)"],_createLayers:function _createLayers(svg,numberOfLayers,propName){for(var layers=[],name=propName?propName:"layer",i=0;i<numberOfLayers;i++){var layer;if(Polymer.Settings.useNativeShadow){layer=svg.append("g")}else{var g=document.createElementNS("http://www.w3.org/2000/svg","g");layer=Px.d3.select(Polymer.dom(svg.node()).appendChild(g))}layer.attr("id","layer"+i);layers.push(layer)}this.set(name,layers);this.fire("px-vis-"+name+"-updated",{data:layers,dataVar:name,method:"set"})},_createLayersOnce:function _createLayersOnce(svg,numberOfLayers,generateLayers,propName){if(this.hasUndefinedArguments(arguments)){return}var gen=generateLayers?generateLayers:"generateLayers";if(this[gen]&&this._doesD3HaveValues(svg)&&0<numberOfLayers){this._createLayers(svg,numberOfLayers,propName);this.set(gen,!1)}}},PxVisBehavior.observerCheck,PxVisBehaviorD3.svg,PxVisBehavior.commonMethods];PxVisBehaviorChart.mutedAxes={properties:{mutedAxes:{type:Object,notify:!0,value:function value(){return{}}}}};PxVisBehaviorChart.multiAxisLasso={properties:{_lassoCrosshairData:{type:Object,value:function value(){return{}}},resetLassoData:{type:Boolean,value:!1,observer:"_resetLasso"}},lasso:function lasso(){for(var yScale=this.isMultiY?this.y[this.extentsData.dimension]:this.y,i=0;i<this.chartData.length;i++){this._searchForDataInArea(this.extentsData.dimension,yScale,this.chartData[i],this.extentsData.extents)}this._calcLassoData(this.extentsData.dimension)},_searchForDataInArea:function _searchForDataInArea(dim,y,d,ext){if(this._combinedMutedSeries[d[this.seriesKey]]){return}if(y.domain()[0]>d[dim]||d[dim]>y.domain()[1]){return}if(this.timeDomain&&this.timeDomain.x&&(d[this.seriesKey]<this.timeDomain.x[0]||d[this.seriesKey]>this.timeDomain.x[1])){return}var dpx=y(d[dim]);if(dpx>=ext[0]&&dpx<=ext[1]){this._lassoCrosshairData[d[this.seriesKey]]=d}},_calcLassoData:function _calcLassoData(dim){for(var keys=Object.keys(this._lassoCrosshairData),combined={detail:{rawData:[],timeStamps:keys}},i=0;i<keys.length;i++){combined.detail.rawData.push(this._lassoCrosshairData[keys[i]])}this._calcCrosshair(combined)},_resetLasso:function _resetLasso(){if(this.hasUndefinedArguments(arguments)){return}this._lassoCrosshairData={}}};PxVisBehaviorChart.extentsDataRouter=[{properties:{_extentsDataRoutes:{type:Object,value:function value(){return{zoom:"zoom",pan:"pan",lasso:"lasso"}}}},observers:["_extentsDataRouter(extentsData.*)"],_extentsDataRouter:function _extentsDataRouter(){if(this.hasUndefinedArguments(arguments)){return}if(!this.extentsAction){return}var fn=this._extentsDataRoutes[this.extentsAction];if(!fn){console.warn("_extentsDataRoutes does not have a method to call "+this.extentsAction);return}if(!this[fn]){console.warn("Method "+fn+" is not defined");return}this[fn]()}},PxVisBehavior.observerCheck,PxVisBehavior.extentsData];PxVisBehaviorChart.zoomGeneric=[{properties:{zoomStack:{type:Array,value:function value(){return[]}},zoomInPercentage:{type:Number,value:.5},zoomOutPercentage:{type:Number,value:.5},_isPanning:{type:Boolean,value:!1}},zoomIn:function zoomIn(){this.set("extentsAction","zoom");this._autoZoom(!0)},zoomOut:function zoomOut(){this.set("extentsAction","zoom");this._autoZoom(!1)},_intSpaceStartPan:function _intSpaceStartPan(){this.set("_isPanning",!0)},_intSpaceStopPan:function _intSpaceStopPan(){this.set("_isPanning",!1)}},PxVisBehavior.extentsData,PxVisBehaviorChart.extentsDataRouter];PxVisBehaviorChart.zooming=[{properties:{_originalOrdinalExtents:{type:Array}},listeners:{"px-vis-toolbar-reset-zoom":"resetZoom","px-vis-toolbar-zoom-in":"zoomIn","px-vis-toolbar-zoom-out":"zoomOut","px-vis-toolbar-undo-zoom":"undoZoom","px-vis-interaction-space-start-panning":"_intSpaceStartPan","px-vis-interaction-space-stop-panning":"_intSpaceStopPan"},undoZoom:function undoZoom(){if(1===this.zoomStack.length){this.resetZoom()}var extentsData=this.pop("zoomStack");if(extentsData){this.set("selectedDomain",extentsData);this.fire("px-vis-selected-domain-updated",{data:extentsData,method:"set",dataVar:"selectedDomain"});this._notifyZoomed(!1)}},_saveZoomState:function _saveZoomState(){this._saveOrdinalOriginalExtents();var selectedDomain="reset"===this.selectedDomain?{}:this.selectedDomain;if(!this.selectedDomain.y||0===this.selectedDomain.y.length){var newY=this._processYValues(function(axis,index){return axis.domain()});selectedDomain.y=newY}this.push("zoomStack",selectedDomain)},_saveOrdinalOriginalExtents:function _saveOrdinalOriginalExtents(){if(0===this.zoomStack.length&&("ordinal"===this.xAxisType||"ordinal"===this.yAxisType)){var domains;domains=this._processYValues(function(axis,index){return axis.domain()});this.set("_originalOrdinalExtents",[this.x.domain(),domains])}},_autoZoom:function _autoZoom(isZoomIn){var xMin=this.x.domain()[0],xMax=this.x.domain()[1],newExtents={},zoomSelection=this.selectionType||"xy";this._saveOrdinalOriginalExtents();if("xy"===zoomSelection||"xAxis"===zoomSelection){if("ordinal"===this.xAxisType){newExtents.eX=this._calcNewOrdinalExtents(this.x.domain(),this._originalOrdinalExtents[0],isZoomIn)}else{xMin=this._convertValue(xMin,this.xAxisType,!0);xMax=this._convertValue(xMax,this.xAxisType,!0);newExtents.eX=this._calcNewLinearExtents(xMin,xMax,isZoomIn);newExtents.eX[0]=this._convertValue(newExtents.eX[0],this.xAxisType,!1);newExtents.eX[1]=this._convertValue(newExtents.eX[1],this.xAxisType,!1)}}else{newExtents.eX=[xMin,xMax]}if("xy"===zoomSelection||"yAxis"===zoomSelection){if("ordinal"===this.yAxisType){newExtents.eY=this._processYValues(function(axis,index){var originalDomain=this._originalOrdinalExtents[1];if(index||0===index){originalDomain=originalDomain[index]}return this._calcNewOrdinalExtents(axis.domain(),originalDomain,isZoomIn)})}else{newExtents.eY=this._processYValues(function(axis,index){return this._calcNewLinearExtents(axis.domain()[0],axis.domain()[1],isZoomIn)})}}else{newExtents.eY=this._processYValues(function(axis,index){return[axis.domain()[0],axis.domain()[1]]})}this.set("extentsData",newExtents)},_calcNewOrdinalExtents:function _calcNewOrdinalExtents(currentDomain,originalDomain,isZoomIn){if(isZoomIn){return this._calcNewZoomedInOrdinal(currentDomain)}else{return this._calcNewZoomedOutOrdinal(currentDomain,originalDomain)}},_calcNewZoomedInOrdinal:function _calcNewZoomedInOrdinal(currentDomain){var _Mathceil=Math.ceil,newCount=_Mathceil(currentDomain.length*this.zoomInPercentage),removeCount=currentDomain.length-newCount,removeOnLeft=_Mathceil(removeCount/2),removeOnRight=Math.floor(removeCount/2);currentDomain.splice(0,removeOnLeft);currentDomain.splice(currentDomain.length-removeOnRight);return currentDomain},_calcNewZoomedOutOrdinal:function _calcNewZoomedOutOrdinal(currentDomain,originalDomain){var _Mathceil2=Math.ceil,newCount=Math.min(_Mathceil2(currentDomain.length/this.zoomOutPercentage),originalDomain.length),addCount=newCount-currentDomain.length,addOnLeft=_Mathceil2(addCount/2),addOnRight=Math.floor(addCount/2),mostLeftIndex=originalDomain.indexOf(currentDomain[0]),mostRightIndex=originalDomain.indexOf(currentDomain[currentDomain.length-1]);if(mostLeftIndex<addOnLeft){var diff=addOnLeft-mostLeftIndex;addOnLeft-=diff;addOnRight+=diff}if(mostRightIndex<addOnRight){var diff=addOnRight-mostRightIndex;addOnRight-=diff;addOnLeft+=diff}for(var i=1;i<addOnLeft+1;i++){currentDomain.splice(0,0,originalDomain[mostLeftIndex-i])}for(var i=1;i<addOnRight+1;i++){currentDomain.splice(currentDomain.length,0,originalDomain[mostRightIndex+i])}return currentDomain},_calcNewLinearExtents:function _calcNewLinearExtents(min,max,isZoomIn){var range=max-min,result=[];result[0]=isZoomIn?min+range*this.zoomInPercentage/2:min-range*this.zoomOutPercentage/2;result[1]=isZoomIn?max-range*this.zoomInPercentage/2:max+range*this.zoomOutPercentage/2;return result},_convertValue:function _convertValue(value,axisType,convertFrom){if(convertFrom){return"time"===axisType||"timeLocal"===axisType?+value:value}else{return"time"===axisType||"timeLocal"===axisType?new Date(value):value}},_zoomOrPan:function _zoomOrPan(){this.set("selectedDomain",{x:this.extentsData.eX,y:this.extentsData.eY});this.fire("px-vis-selected-domain-updated",{data:{x:this.extentsData.eX,y:this.extentsData.eY},method:"set",dataVar:"selectedDomain"});this._notifyZoomed(!1)},zoom:function zoom(){this._saveZoomState();this._zoomOrPan()},pan:function pan(){this._zoomOrPan()},resetZoom:function resetZoom(){if("reset"===this.selectedDomain){this.set("selectedDomain","rereset")}else{this.set("selectedDomain","reset")}this.splice("zoomStack",0,this.zoomStack.length);this.fire("px-vis-selected-domain-updated",{data:"reset",method:"set",dataVar:"selectedDomain"});this._notifyZoomed(!0)},_notifyZoomed:function _notifyZoomed(isReset){var domains=this._processYValues(function(axis,index){return axis.domain()});this.fire("px-vis-zoomed",{x:this.x.domain(),y:domains,reset:isReset,panning:this._isPanning})}},PxVisBehavior.extentsData,PxVisBehaviorD3.selectedDomain,PxVisBehavior.axisTypes,PxVisBehaviorD3.axes,PxVisBehavior.zoomSelection,PxVisBehaviorChart.zoomGeneric];PxVisBehaviorChart.actionRequest={listeners:{"px-vis-action-request":"_actionRequest","px-vis-event-request":"_eventRequest"},_actionRequest:function _actionRequest(evt){var fn=evt.detail.function,data=evt.detail.data;if(fn){fn=fn.bind(this);fn(data)}evt.stopPropagation()},_eventRequest:function _eventRequest(evt){var eventName=evt.detail.eventName?evt.detail.eventName:"px-vis-event";this.fire(evt.detail.eventName,{data:evt.detail.data});evt.stopPropagation()}};PxVisBehaviorChart.toolbarSubConfig={properties:{toolbarSubConfig:{type:Object}}};PxVisBehaviorChart.noDebounceOnPanning={properties:{_oldLinesDrawDebounceTime:{type:Number},_oldScatterDrawDebounceTime:{type:Number},_oldThresholdDrawDebounceTime:{type:Number}},listeners:{"px-vis-interaction-space-start-panning":"_startPanning","px-vis-interaction-space-stop-panning":"_stopPanning"},_startPanning:function _startPanning(){var lines=Polymer.dom(this.root).querySelectorAll("px-vis-line-svg"),scatter=Polymer.dom(this.root).querySelectorAll("px-vis-scatter"),threshold=Polymer.dom(this.root).querySelector("px-vis-threshold");if(lines&&0<lines.length){this._oldLinesDrawDebounceTime=lines[0].drawDebounceTime;for(var i=0;i<lines.length;i++){lines[i].set("drawDebounceTime",0)}}if(scatter&&scatter.length){this._oldScatterDrawDebounceTime=scatter[0].drawDebounceTime;for(var i=0;i<scatter.length;i++){scatter[i].set("drawDebounceTime",0)}}if(threshold){this._oldThresholdDrawDebounceTime=threshold.drawDebounceTime;threshold.set("drawDebounceTime",0)}},_stopPanning:function _stopPanning(){var lines=Polymer.dom(this.root).querySelectorAll("px-vis-line-svg"),scatter=Polymer.dom(this.root).querySelectorAll("px-vis-scatter"),threshold=Polymer.dom(this.root).querySelector("px-vis-threshold");if(lines){for(var i=0;i<lines.length;i++){lines[i].set("drawDebounceTime",this._oldLinesDrawDebounceTime)}}if(scatter){for(var i=0;i<scatter.length;i++){scatter[i].set("drawDebounceTime",this._oldScatterDrawDebounceTime)}}if(threshold){threshold.set("drawDebounceTime",this._oldThresholdDrawDebounceTime)}}};PxVisBehaviorChart.showTooltip=[{properties:{showTooltip:{type:Boolean,value:!1},_internalShowTooltip:{type:Boolean,value:!0},_computedShowTooltip:{type:Boolean,computed:"_computeShowTooltip(showTooltip, _internalShowTooltip)"}},_computeShowTooltip:function _computeShowTooltip(showTooltip,_internalShowTooltip){if(this.hasUndefinedArguments(arguments)){return}return showTooltip&&_internalShowTooltip}},PxVisBehavior.observerCheck];PxVisBehaviorChart.multiAxis=[{properties:{leftAxisSize:{type:Number,notify:!0},rightAxisSize:{type:Number,notify:!0},numLeftAxes:{type:Number,notify:!0},numRightAxes:{type:Number,notify:!0},_axisX:{type:Object,notify:!0},_axisDomainChanged:{type:Number,value:0},_multiAxisSeriesConfig:{type:Object,notify:!0}},_addAxisToList:function _addAxisToList(axisId,axisNum,thisSet,otherSet,dims){if(otherSet[axisId]||0===otherSet[axisId]){console.warn(axisId+" is defined on both the left and right side. Defaulting to first side (\u2267\u03C9\u2266)");return}if(dims[axisNum]){if(dims[axisNum]!==axisId){console.warn(axisId+" & "+dims[axisNum]+" are both defined at axis number "+axisNum);if(!thisSet[axisId]&&0!==thisSet[axisId]){thisSet[axisId]=dims.length;dims.push(axisId)}}return}thisSet[axisId]=axisNum;dims[axisNum]=axisId},_calcAxes:function _calcAxes(completeSeriesConfig){if(this._doesObjHaveValues(this.completeSeriesConfig)){for(var keys=Object.keys(this.completeSeriesConfig),lSet={},rSet={},lDims=[],rDims=[],seriesToAxes={},i=0;i<keys.length;i++){if(this.completeSeriesConfig[keys[i]].axis){var k=keys[i],axis=this.completeSeriesConfig[k].axis,axisId=axis.id;if(seriesToAxes[axisId]){seriesToAxes[axisId].push(k)}else{seriesToAxes[axisId]=[k]}if("right"===axis.side){this._addAxisToList(axisId,axis.number,rSet,lSet,rDims)}else{this._addAxisToList(axisId,axis.number,lSet,rSet,lDims)}}}lDims=lDims.filter(Boolean);rDims=rDims.filter(Boolean);this.set("numLeftAxes",lDims.length);this.set("numRightAxes",rDims.length);this.set("axes",lDims.concat(rDims));this.set("_axisX",this._setAxisScale(lDims.sort(),rDims.sort(),this.leftAxisSize,this.rightAxisSize));this.set("dimensions",this.axes);this.set("seriesToAxes",seriesToAxes);if("function"===typeof this._axisX){this.set("_axisDomainChanged",this._axisDomainChanged+1)}this.set("_multiAxisSeriesConfig",this.completeSeriesConfig)}},_calcMultiMargins:function _calcMultiMargins(margin,leftAxisWidth,rightAxisWidth){var _Mathmax2=Math.max,leftAxisWidth=leftAxisWidth||50,rightAxisWidth=rightAxisWidth||50;margin.left=_Mathmax2(leftAxisWidth*this.numLeftAxes,margin.left);margin.right=_Mathmax2(rightAxisWidth*this.numRightAxes,margin.right);this.set("leftAxisSize",leftAxisWidth);this.set("rightAxisSize",rightAxisWidth)},_returnYScale:function _returnYScale(seriesId,config){if(this.domainChanged){if("object"===babelHelpers.typeof(this.y)){var d=config[seriesId].axis.id;if(this.y&&this.y[d]){return this.y[d]}}else if("function"===typeof this.y){return this.y}}return}},PxVisBehavior.dimensions,PxVisBehavior.seriesToAxes];PxVisBehaviorChart.sizeVerticalRegister=[{properties:{_verticalRegisterHeight:{type:Number},_registerHeight:{type:Number,computed:"_computeRegisterHeight(_verticalRegisterHeight, registerConfig.*)"},_verticalRegisterHeightDeductions:{type:Array},_verticalRegisterDrawingCanvasId:{type:String}},observers:["_heightChanged(height, _verticalRegisterDrawingCanvasId, _verticalRegisterHeightDeductions)"],ready:function ready(){this.set("_verticalRegisterHeight",this.height)},_heightChanged:function _heightChanged(){if(this.hasUndefinedArguments(arguments)){return}this._computeVerticalRegisterHeight()},_computeVerticalRegisterHeight:function _computeVerticalRegisterHeight(deductions){var _Mathmax3=Math.max;this.debounce("_computeVerticalRegisterHeight",function(){var _this2=this,deductionsTotal=0;if(!deductions){if(this._verticalRegisterHeightDeductions&&this._verticalRegisterHeightDeductions.length){window.requestAnimationFrame(function(){for(var i=0,el;i<_this2._verticalRegisterHeightDeductions.length;i++){el=_this2.$$("#"+_this2._verticalRegisterHeightDeductions[i]);if(el){deductionsTotal+=el.getBoundingClientRect().height}}_this2.set("_verticalRegisterHeight",_Mathmax3(+_this2.$[_this2._verticalRegisterDrawingCanvasId].height+deductionsTotal,0))})}}else{for(var i=0;i<deductions.length;i++){deductionsTotal+=deductions[i]}this.set("_verticalRegisterHeight",_Mathmax3(+this.$[this._verticalRegisterDrawingCanvasId].height+deductionsTotal,0))}}.bind(this),5)},_computeRegisterHeight:function _computeRegisterHeight(){if(this.registerConfig&&"horizontal"===this.registerConfig.type){return this.registerConfig.height?this.registerConfig.height:""}return this._verticalRegisterHeight}},PxVisBehavior.observerCheck,PxVisBehavior.baseSize];PxVisBehaviorChart.axisRegister=[{properties:{hideAxisRegister:{type:Boolean,value:!1},_axisRegisterConfig:{type:Object},_axisRegisterTooltipData:{type:Object}},observers:["_computedAxisRegisterConf(axes, completeSeriesConfig, hideAxisRegister)"],_computedAxisRegisterConf:function _computedAxisRegisterConf(axes,completeSeriesConfig){if(this.hasUndefinedArguments(arguments)||this.hideAxisRegister){return}var axisConfig={},configTitle,tooltipData={};tooltipData.series=[];tooltipData.seriesObj={};for(var i=0;i<axes.length;i++){configTitle=completeSeriesConfig[axes[i]]?completeSeriesConfig[axes[i]].title:axes[i];axisConfig[axes[i]]={name:configTitle,y:axes[i],yAxisUnit:completeSeriesConfig[axes[i]]&&completeSeriesConfig[axes[i]].yAxisUnit?completeSeriesConfig[axes[i]].yAxisUnit:""};tooltipData.series.push({name:axes[i]});tooltipData.seriesObj[axes[i]]={}}this.set("_axisRegisterConfig",axisConfig);if(!this._ttDataHaveSameSeries(this._axisRegisterTooltipData,tooltipData)){this.set("_axisRegisterTooltipData",tooltipData)}},_ttDataHaveSameSeries:function _ttDataHaveSameSeries(data1,data2){if(!data1&&data2||!data2&&data1){return!1}if(data1.series&&data2.series&&data1.series.length!==data2.series.length){return!1}if(JSON.stringify(data1.seriesObj)===JSON.stringify(data2.seriesObj)){return!0}return!1},_buildAxisTooltipData:function _buildAxisTooltipData(values,time){if(this._axisRegisterTooltipData&&this._axisRegisterTooltipData.series&&!this.hideAxisRegister){for(var copy={series:[],seriesObj:{},time:time||null,dataset:values},i=0;i<this._axisRegisterTooltipData.series.length;i++){var newSeries={},name=this._axisRegisterTooltipData.series[i].name;newSeries.name=name;if(values&&(values[name]||0===values[name])&&(!this.hardMute||!this.mutedAxes[name])){newSeries.value={};newSeries.value[name]=values[name]}copy.series.push(newSeries);copy.seriesObj[name]=newSeries}this.set("_axisRegisterTooltipData",copy)}else{if(!this._axisRegisterTooltipData){this._axisRegisterTooltipData={}}this.set("_axisRegisterTooltipData.dataset",values?values:null)}}},PxVisBehavior.observerCheck,PxVisBehavior.dimensions,PxVisBehavior.completeSeriesConfig,PxVisBehaviorChart.mutedAxes,PxVisBehaviorChart.getHideClass];PxVisBehaviorChart.categoryRegister=[{properties:{hideCategoryRegister:{type:Boolean,value:!1},_hideCategoryRegister:{type:Boolean,value:!0},_categoryRegisterConfig:{type:Object},_categoryRegisterTooltipData:{type:Object}},observers:["_computeCategoryRegisterConfig(categoryKey, completeSeriesConfig, categories, _hideCategoryRegister)","_computeHideCategoryRegister(hideCategoryRegister, categoryKey)"],_computeCategoryRegisterConfig:function _computeCategoryRegisterConfig(){if(this.hasUndefinedArguments(arguments)||this._hideCategoryRegister){return}if("undefined"!==typeof this.categoryKey){var tooltipData={},config={},currentCat,catName;tooltipData.series=[],tooltipData.seriesObj={};for(var i=0;i<this.categories.length;i++){currentCat=this.categories[i].toString();if(this.completeSeriesConfig[currentCat]&&this.completeSeriesConfig[currentCat].name.toString()!==currentCat){catName=this.completeSeriesConfig[currentCat].name}else{catName=this.categoryKey+" - "+currentCat}if(this.completeSeriesConfig[currentCat]){config[currentCat]={};config[currentCat].name=catName;config[currentCat].color=this.completeSeriesConfig[currentCat].color?this.completeSeriesConfig[currentCat].color:this._getColor(this.startColorIndex+i)}else{config[currentCat]={name:catName,color:this._getColor(this.startColorIndex+i)}}tooltipData.series.push({name:currentCat});tooltipData.seriesObj[currentCat]={}}this.set("_categoryRegisterConfig",config);this.set("_categoryRegisterTooltipData",tooltipData)}},_computeHideCategoryRegister:function _computeHideCategoryRegister(){if(this.hasUndefinedArguments(arguments)){return}this.set("_hideCategoryRegister",this.hideCategoryRegister||!this.categoryKey)}},PxVisBehavior.observerCheck,PxVisBehavior.completeSeriesConfig,PxVisBehavior.categories,PxVisBehaviorChart.getHideClass];PxVisBehaviorChart.categoryAndAxisRegisterConfigs=[{properties:{axisRegisterConfig:{type:Object},categoryRegisterConfig:{type:Object}},observers:["_axisRegisterConfigChanged(axisRegisterConfig.*)","_categoryRegisterConfigChanged(categoryRegisterConfig.*)"],_categoryRegisterConfigChanged:function _categoryRegisterConfigChanged(conf){if(this.hasUndefinedArguments(arguments)){return}this._applyConfigToElement(this.categoryRegisterConfig,this.$.categoryRegister)},_axisRegisterConfigChanged:function _axisRegisterConfigChanged(conf){if(this.hasUndefinedArguments(arguments)){return}this._applyConfigToElement(this.axisRegisterConfig,this.$.axisRegister)}},PxVisBehavior.observerCheck,PxVisBehaviorChart.subConfiguration];PxVisBehaviorChart.registerPagnationBase={properties:{_currentPage:{type:Number,value:0},_registerCurrentPage:{type:Number,value:1},_registerTotalPages:{type:Number,value:1},_registerDisplayPageArrows:{type:Boolean,value:!1}},ready:function ready(){this.addEventListener("px-vis-register-page-change",this._changePage.bind(this))},_changePage:function _changePage(evt){this._currentPage+=evt.detail.direction;if(0>this._currentPage){this._currentPage=this.tooltipData.additionalPoints.length}else if(this._currentPage>this.tooltipData.additionalPoints.length){this._currentPage=0}this.set("_registerCurrentPage",this._currentPage+1);this._updateRegisterData()},_resetPages:function _resetPages(){this._currentPage=0;this.set("_registerCurrentPage",1);if(this.tooltipData.additionalPoints&&this.tooltipData.additionalPoints.length){this.set("_registerDisplayPageArrows",!0);this.set("_registerTotalPages",this.tooltipData.additionalPoints.length+1)}else{this.set("_registerDisplayPageArrows",!1);this.set("_registerTotalPages",1)}}};PxVisBehaviorChart.registerPagnation=[{properties:{_registerTooltipData:{type:Object}},_tooltipDataUpdated:function _tooltipDataUpdated(){this._resetPages();this.set("_registerTooltipData",this.tooltipData)},_updateRegisterData:function _updateRegisterData(){if(0===this._currentPage){this.set("_registerTooltipData",this.tooltipData)}else{this.set("_registerTooltipData",this.tooltipData.additionalPoints[this._currentPage-1])}}},PxVisBehaviorChart.registerPagnationBase];PxVisBehaviorChart.registerPagnationMultiAxis=[{_updateRegisterData:function _updateRegisterData(){if(0===this._currentPage){this._buildAxisTooltipData(this.tooltipData.dataset,this.tooltipData.time);this.set("_axisRegisterIconColor",this.tooltipData.color)}else{this._buildAxisTooltipData(this.tooltipData.additionalPoints[this._currentPage-1].dataset,this.tooltipData.additionalPoints[this._currentPage-1].time);this.set("_axisRegisterIconColor",this.tooltipData.additionalPoints[this._currentPage-1].color)}}},PxVisBehaviorChart.registerPagnationBase];PxVisBehaviorChart.tooltipFollowMouseCalculation=[{properties:{_tooltipCalcMousePosHandler:{type:Function},_tooltipCalcHoverTargetId:{type:String},mousePosition:{type:Array}},observers:["_computedShowTooltipChanged(_computedShowTooltip)"],_computedShowTooltipChanged:function _computedShowTooltipChanged(){if(this.hasUndefinedArguments(arguments)){return}if(!this._tooltipCalcMousePosHandler){this._createHandler()}if(this._computedShowTooltip){this.$[this._tooltipCalcHoverTargetId].addEventListener("mousemove",this._tooltipCalcMousePosHandler)}else{this.$[this._tooltipCalcHoverTargetId].removeEventListener("mousemove",this._tooltipCalcMousePosHandler)}},_calcMousePos:function _calcMousePos(evt){this.set("mousePosition",[evt.pageX,evt.pageY])},_createHandler:function _createHandler(){this._tooltipCalcMousePosHandler=this._calcMousePos.bind(this)}},PxVisBehavior.observerCheck,PxVisBehaviorChart.showTooltip];PxVisBehaviorChart.thresholdConfig={properties:{thresholdConfig:{type:Object}}};PxVisBehaviorChart.combineMutes=[{properties:{_combinedMutedSeries:{type:Object,value:function value(){return{}}},mutedSeriesDomain:{type:Object,value:function value(){return{}}},mutedSeriesBrush:{type:Object,value:function value(){return{}}},mutedSeriesCategories:{type:Object,value:function value(){return{}}}},observers:["_combineMutes(mutedSeriesBrush, mutedSeriesDomain, mutedSeriesCategories.*)"],_combineMutes:function _combineMutes(m1,m2){if(this.hasUndefinedArguments(arguments)){return}var muted={},mutedCategories=Object.keys(this.mutedSeriesCategories).filter(function(cat){return this.mutedSeriesCategories[cat]}.bind(this));for(var k in m1){muted[k]=m1[k]}for(var k in m2){muted[k]=m2[k]}if(mutedCategories.length&&this.chartData){for(var i=0;i<this.chartData.length;i++){for(var j=0;j<mutedCategories.length;j++){if(this.chartData[i][this.categoryKey]===mutedCategories[j]){muted[this.chartData[i][this.seriesKey]]=!0;break}}}}this.set("_combinedMutedSeries",muted);this.set("_combinedMutedChanged",this._combinedMutedChanged?!1:!0)}},PxVisBehavior.observerCheck];PxVisBehaviorChart.multiAxisMuting=[{properties:{_mutedExtents:{type:Object,value:function value(){return{}}}},ready:function ready(){this._extentsDataRoutes.mute="_addToMutedExtents"},_addToMutedExtents:function _addToMutedExtents(){this._mutedExtents[this.extentsData.dimension]=this.extentsData.extents;this._calcMutedSeries()},_calcMutedSeries:function _calcMutedSeries(){for(var dims=Object.keys(this._mutedExtents),mutedSeries={},brushDomains={},k,i=0;i<dims.length;i++){k=dims[i];this._calcSingleMutedSeries(this._mutedExtents[k],k,mutedSeries,brushDomains)}this.set("mutedSeriesBrush",mutedSeries);this.set("brushDomains.muted",brushDomains)},_calcSingleMutedSeries:function _calcSingleMutedSeries(extents,dim,series,brushDomains){if(!extents||0===extents.length){return}if(this.chartData&&0<this.chartData.length){var domain=[],lower=0,upper=1,y0,y1;if(this._flipAxisLogic){lower=1;upper=0}if("function"===typeof this.y){y0=this.y.invert(extents[lower]);y1=this.y.invert(extents[upper])}else{y0=this.y[dim].invert(extents[lower]);y1=this.y[dim].invert(extents[upper])}for(var i=0;i<this.chartData.length;i++){if(this.brushToRemove){if(y0>=this.chartData[i][dim]&&this.chartData[i][dim]>=y1){series[this.chartData[i][this.seriesKey]]=!0}}else{if(y0<=this.chartData[i][dim]||this.chartData[i][dim]<=y1){series[this.chartData[i][this.seriesKey]]=!0}}domain=[y0,y1]}brushDomains[dim]=domain}},deleteMutedBrushes:function deleteMutedBrushes(){this.set("_brushDomains.muted",{})}},PxVisBehaviorChart.extentsDataRouter];PxVisBehaviorChart.multiAxisZoom=[{listeners:{"px-vis-toolbar-reset-zoom":"resetZoom","px-vis-toolbar-zoom-in":"zoomIn","px-vis-toolbar-zoom-out":"zoomOut","px-vis-toolbar-undo-zoom":"undoZoom","px-vis-interaction-space-start-panning":"_saveZoomState"},zoom:function zoom(){if(this.extentsData.extents.length){this._saveZoomState();this._zoomOrPan()}},pan:function pan(){this._zoomOrPan()},_saveZoomState:function _saveZoomState(){var domains=this._processYValues(function(axis,index){return axis.domain()});this.zoomStack.push(domains)},_zoomOrPan:function _zoomOrPan(){var exts=this.extentsData.extents,domains;if("function"===typeof this.y){domains=[this.y.invert(exts[0]),this.y.invert(exts[1])]}else if(this.commonAxis){var dims=Object.keys(this.y),dim;domains={};for(var i=0;i<dims.length;i++){dim=dims[i];domains[dim]=[this.y[dim].invert(exts[1]),this.y[dim].invert(exts[0])]}}else{var dim=this.extentsData.dimension;domains={};domains[dim]=[this.y[dim].invert(exts[1]),this.y[dim].invert(exts[0])]}this.set("axesDomain",domains)},_autoZoom:function _autoZoom(isZoomIn){this._saveZoomState();var perc=isZoomIn?1-this.zoomInPercentage:1+this.zoomOutPercentage,domains=this._processYValues(function(axis,index){var d=axis.domain();d[0]=d[0]*perc;d[1]=d[1]*perc;return d});this.set("axesDomain",domains)},undoZoom:function undoZoom(){if(!this.zoomStack.length){return}this.set("axesDomain",this.zoomStack.pop())},resetZoom:function resetZoom(){if(!this.zoomStack.length){return}this.set("axesDomain",this.zoomStack[0]);this.zoomStack=[]}},PxVisBehaviorChart.zoomGeneric];PxVisBehaviorChart.useCategoryInTooltip={properties:{useCategoryInTooltip:{type:Boolean,value:!1}}};PxVisBehaviorChart.tooltipSizing=[{properties:{_svgClientRect:Object,_canvasClientRect:Object,_winX:Number,_winY:Number},observers:["_setupSizingListener(showTooltip)"],detached:function detached(){this.removeEventListener("px-vis-tooltip-sizing-request",this._getSizingBound)},attached:function attached(){this._getSizingBound=this._getSizing.bind(this);this._setupSizingListener()},_setupSizingListener:function _setupSizingListener(){if(this.showTooltip){this.addEventListener("px-vis-tooltip-sizing-request",this._getSizingBound)}else{this.removeEventListener("px-vis-tooltip-sizing-request",this._getSizingBound)}},_getSizing:function _getSizing(){requestAnimationFrame(this._getImmediateSizing.bind(this))},_getImmediateSizing:function _getImmediateSizing(){if(this.pxSvgElem){this._svgClientRect=this.pxSvgElem.getBoundingClientRect()}if(this.canvasContext&&this.canvasContext.canvas){this._canvasClientRect=this.canvasContext.canvas.getBoundingClientRect()}this._winX=window.pageXOffset;this._winY=window.pageYOffset}},PxVisBehaviorChart.showTooltip];PxVisBehaviorChart.centralTooltip=[{properties:(_properties={tooltipRequested:{type:Boolean,value:!1},tooltipOrientation:{type:String,value:"left"},resources:{type:Object,value:function value(){return{en:{Event:"Event",ID:"ID",Timestamp:"Timestamp",X:"X"}}}},useKeyIfMissing:{type:Boolean,value:!0},language:{type:String,value:"en"}},babelHelpers.defineProperty(_properties,"useKeyIfMissing",{type:Boolean,value:!0}),babelHelpers.defineProperty(_properties,"_availableTooltips",{type:Array,value:function value(){return[]}}),babelHelpers.defineProperty(_properties,"_usedTooltipMap",{type:Map,value:function value(){return new Map}}),babelHelpers.defineProperty(_properties,"_lockedTooltips",{type:Set,value:function value(){return new Set}}),_properties),listeners:{"central-tooltip-display-request":"_centralTooltipDisplayRequest","central-tooltip-cancel-request":"_centralTooltipCancelRequest","central-tooltip-lock-request":"_centralTooltipLockRequest","central-tooltip-lock-cancel":"_centralTooltipLockCancel"},observers:["_updateTooltipProps(tooltipOrientation, resources, useKeyIfMissing, language, firstDateTimeFormat, secondDateTimeFormat, separator, timezone)"],ready:function ready(){this._availableTooltips.push(this.$.centralTooltip)},_getTooltipToUse:function _getTooltipToUse(){for(var i=0;i<this._availableTooltips.length;i++){if(!this._lockedTooltips.has(this._availableTooltips[i])){return this._availableTooltips[i]}}return this._createTooltip()},_createTooltip:function _createTooltip(){var copy=this._availableTooltips[0].cloneNode(!0);copy.setAttribute("id","centralTooltip".concat(this._availableTooltips.length));this._availableTooltips.push(copy);this.appendChild(copy);return copy},_centralTooltipDisplayRequest:function _centralTooltipDisplayRequest(evt){var tooltip=this._getTooltipToUse(),content=tooltip.querySelector("px-vis-central-tooltip-content");this._usedTooltipMap.set(evt.detail.origin,tooltip);if(evt.detail.element){tooltip.set("for",evt.detail.element)}if(evt.detail.mouseCoords){tooltip.set("followMouse",!0);tooltip.set("mouseCoords",evt.detail.mouseCoords)}if(evt.detail.orientation){tooltip.set("orientation",evt.detail.orientation)}if(evt.detail.data){content.set("tooltipDataResult",evt.detail.data)}tooltip.set("opened",!0);evt.preventDefault();evt.stopPropagation()},_centralTooltipCancelRequest:function _centralTooltipCancelRequest(evt){var tooltip=this._usedTooltipMap.get(evt.detail.origin),content=tooltip.querySelector("px-vis-central-tooltip-content");tooltip.set("opened",!1);tooltip.set("for",void 0);tooltip.set("followMouse",!1);tooltip.set("mouseCoords",void 0);content.set("tooltipDataResult",[]);this._usedTooltipMap.delete(evt.detail.origin);evt.preventDefault();evt.stopPropagation()},_centralTooltipLockRequest:function _centralTooltipLockRequest(evt){var tooltip=this._usedTooltipMap.get(evt.detail.origin);this._lockedTooltips.add(tooltip);evt.preventDefault();evt.stopPropagation()},_centralTooltipLockCancel:function _centralTooltipLockCancel(evt){this._lockedTooltips.delete(evt.detail.origin);evt.preventDefault();evt.stopPropagation()},_resizeTooltip:function _resizeTooltip(){this.$.tooltip.setPosition()},_updateTooltipProps:function _updateTooltipProps(){if(this.hasUndefinedArguments(arguments)){return}if(1===this._availableTooltips.length){return}for(var i=1;i<this._availableTooltips.length;i++){this._availableTooltips[i].set("tooltipOrientation",this.tooltipOrientation);var content=this._availableTooltips[i].querySelector("px-vis-central-tooltip-content");content.set("resources",this.resources);content.set("useKeyIfMissing",this.useKeyIfMissing);content.set("language",this.language);content.set("firstDateTimeFormat",this.firstDateTimeFormat);content.set("secondDateTimeFormat",this.secondDateTimeFormat);content.set("separator",this.separator);content.set("timezone",this.timezone)}}},PxVisBehaviorTime.datetime];</script>
</head><body></body></html>