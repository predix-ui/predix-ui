var extentCalc={_defaultScaleValue:{x:[1/0,-Infinity],y:[1/0,-Infinity]}};extentCalc.determineExtents=function determineExtents(data){var xOrd="ordinal"===this.xAxisType||"scaleBand"===this.xAxisType,yOrd="ordinal"===this.yAxisType||"scaleBand"===this.yAxisType,xTime="time"===this.xAxisType||"timeLocal"===this.xAxisType,doX=xTime?!1:!0,doY=!0,keys=Object.keys(this.completeSeriesConfig),extents={x:[],y:[]};extents.x=this._checkForExtents(xOrd,this.chartExtents,this.dataExtents,"x");extents.y=this.axes&&this.axes.length?this._calcMultiAxisExtents(data):this._checkForExtents(yOrd,this.chartExtents,this.dataExtents,"y");if(0<extents.x.length&&extents.x[0]!==1/0&&extents.x[1]!==-Infinity){xTime=!1;doX=!1}if(!Array.isArray(extents.y)||0<extents.y.length&&extents.y[0]!==1/0&&extents.y[1]!==-Infinity){doY=!1}if(0===data.length){xTime=!1;doX=!1;doY=!1}if(doX||doY||xTime){this._findMinMax(data,doX,doY,xOrd,yOrd,xTime,extents,keys)}if(extents.x[0]===1/0){extents.x[0]=0}if(extents.x[1]===-Infinity){extents.x[1]=1}if(Array.isArray(extents.y)&&extents.y[0]===1/0){extents.y[0]=0}if(Array.isArray(extents.y)&&extents.y[1]===-Infinity){extents.y[1]=1}if(extents.x[1]===extents.x[0]){extents.x[0]-=.5;extents.x[1]+=.5}if(Array.isArray(extents.y)){if(extents.y[1]===extents.y[0]){extents.y[0]-=.5;extents.y[1]+=.5}}else{for(var yKeys=Object.keys(extents.y),i=0;i<yKeys.length;i++){if(extents.y[yKeys[i]][0]===extents.y[yKeys[i]][1]){extents.y[yKeys[i]][0]-=.5;extents.y[yKeys[i]][1]+=.5}}}return extents}.bind(extentCalc);extentCalc._checkForExtents=function _checkForExtents(isOrd,chartExtents,dataExtents,axis){var exts=[];if(isOrd){if(dataExtents&&dataExtents[axis]){exts=JSON.parse(JSON.stringify(dataExtents[axis]))}if(chartExtents&&chartExtents[axis]){exts=JSON.parse(JSON.stringify(chartExtents[axis]))}}else{var fromChartExtents=!1;exts=this._checkChartExtents(chartExtents,axis);fromChartExtents=2===exts.length?!0:!1;exts=this._checkDataExtents(dataExtents,chartExtents,axis,fromChartExtents,exts);if(2>exts.length){exts=[this._defaultScaleValue[axis][0],this._defaultScaleValue[axis][1]]}}return exts}.bind(extentCalc);extentCalc._checkChartExtents=function _checkChartExtents(cExts,axis){var exts=[];if(cExts&&cExts[axis]&&2===cExts[axis].length){exts[0]="dynamic"===cExts[axis][0]?1/0:cExts[axis][0];exts[1]="dynamic"===cExts[axis][1]?-Infinity:cExts[axis][1]}return exts}.bind(extentCalc);extentCalc._checkDataExtents=function _checkDataExtents(dExts,cExts,axis,bool,exts){var result=exts||[];if(dExts&&dExts[axis]&&2===dExts[axis].length){if(bool){result[0]="dynamic"===cExts[axis][0]?dExts[axis][0]:cExts[axis][0];result[1]="dynamic"===cExts[axis][1]?dExts[axis][1]:cExts[axis][1]}else{result[0]=Math.min(dExts[axis][0],this._defaultScaleValue[axis][0]);result[1]=Math.max(dExts[axis][1],this._defaultScaleValue[axis][1])}}return result}.bind(extentCalc);extentCalc._findMinMax=function _findMinMax(data,doX,doY,ordX,ordY,timeX,result,keys){var xVal,yVal,dLen=data.length,x=this.completeSeriesConfig[keys[0]].x,y=this.completeSeriesConfig[keys[0]].y,doX0=!ordX&&result.x[0]===1/0?!0:!1,doX1=!ordX&&result.x[1]===-Infinity?!0:!1,doY0=!ordY&&result.y[0]===1/0?!0:!1,doY1=!ordY&&result.y[1]===-Infinity?!0:!1;if(timeX){this._findTimeMM(result,data,dLen,x,doX0,doX1)}if(doX||doY){for(var i=0;i<dLen;i++){xVal=this._getDataExtents(data[i],keys,"x");yVal=this._getDataExtents(data[i],keys,"y");if(doX){this._processDataValues(ordX,result,data,"x",x,i,doX0,doX1,xVal[0],xVal[1])}if(doY){this._processDataValues(ordY,result,data,"y",y,i,doY0,doY1,yVal[0],yVal[1])}}}}.bind(extentCalc);extentCalc._getDataExtents=function _getDataExtents(d,keysArr,axis){for(var a=[],i=0;i<keysArr.length;i++){var key=keysArr[i],val;if(!this.mutedSeries[keysArr[i]]){val=d[this.completeSeriesConfig[key][axis]];if(val||0===val){a.push(val)}}}return[Math.min.apply(null,a),Math.max.apply(null,a)]}.bind(extentCalc);extentCalc._findTimeMM=function _findTimeMM(result,d,l,x,doMin,doMax){if(doMin){this._setMin(result.x,d[0][x])}if(doMax){this._setMax(result.x,d[l-1][x])}}.bind(extentCalc);extentCalc._setMin=function _setMin(r,d){if(null===d){return}if(isNaN(r[0])||r[0]>d){r[0]=d}}.bind(extentCalc);extentCalc._setMax=function _setMax(r,d){if(null===d){return}if(isNaN(r[1])||r[1]<d){r[1]=d}}.bind(extentCalc);extentCalc._processDataValues=function _processDataValues(isOrd,r,d,axis,key,i,doMin,doMax,v0,v1){if(isOrd){if(-1===r[axis].indexOf(d[i][key])){r[axis].push(d[i][key])}}else{if(doMin){this._setMin(r[axis],v0)}if(doMax){this._setMax(r[axis],v1)}}}.bind(extentCalc);extentCalc._checkInSeriesConfig=function _checkInSeriesConfig(exts,a){for(var i=0,s;i<this.seriesToAxes[a].length;i++){s=this.seriesToAxes[a][i];if(!this.hardMute||!this.mutedSeries[s]){exts[a][0]=this.completeSeriesConfig[s].yMin||0===this.completeSeriesConfig[s].yMin?Math.min(this.completeSeriesConfig[s].yMin,exts[a][0]):exts[a][0];exts[a][1]=this.completeSeriesConfig[s].yMax||0===this.completeSeriesConfig[s].yMax?Math.max(this.completeSeriesConfig[s].yMax,exts[a][1]):exts[a][1]}}}.bind(extentCalc);extentCalc._applyChartExtents=function _applyChartExtents(exts,a){var k=this.chartExtents[a]?a:"y";if(this.chartExtents[k]){if("dynamic"===this.chartExtents[k][0]){exts[a][0]=exts[a][0]||0===exts[a][0]?exts[a][0]:1/0}else{exts[a][0]=this.chartExtents[k][0]}if("dynamic"===this.chartExtents[k][1]){exts[a][1]=exts[a][1]||0===exts[a][1]?exts[a][1]:-Infinity}else{exts[a][1]=this.chartExtents[k][1]}}}.bind(extentCalc);extentCalc._searchForExtents=function _searchForExtents(exts,seriesToSearch,data){for(var seriesList=Object.keys(seriesToSearch),i=0;i<data.length;i++){for(var j=0;j<seriesList.length;j++){var s=seriesList[j],sY=this.completeSeriesConfig[s].y,series=seriesToSearch[s],axis=series.axis;if(series.min&&(data[i][sY]||0===data[i][sY])){exts[axis][0]=Math.min(data[i][sY],exts[axis][0])}if(series.max&&(data[i][sY]||0===data[i][sY])){exts[axis][1]=Math.max(data[i][sY],exts[axis][1])}}}}.bind(extentCalc);extentCalc._calcSeriesToSearch=function _calcSeriesToSearch(exts,a,seriesToSearch){for(var i=0,s;i<this.seriesToAxes[a].length;i++){s=this.seriesToAxes[a][i];if(!this.hardMute||!this.mutedSeries[s]){seriesToSearch[s]={axis:a,min:exts[a][0]===1/0?!0:!1,max:exts[a][1]===-Infinity?!0:!1}}}}.bind(extentCalc);extentCalc._calcMultiAxisExtents=function _calcMultiAxisExtents(data){for(var search=!1,exts={},seriesToSearch={},a,keys,i=0;i<this.axes.length;i++){a=this.axes[i];exts[a]=[];exts[a][0]=this._defaultScaleValue.y[0];exts[a][1]=this._defaultScaleValue.y[1];this._checkInSeriesConfig(exts,a);if(this.chartExtents){this._applyChartExtents(exts,a)}if(exts[a][0]===1/0||exts[a][1]===-Infinity){search=!0;this._calcSeriesToSearch(exts,a,seriesToSearch)}}if(search){this._searchForExtents(exts,seriesToSearch,data)}keys=Object.keys(exts);for(var i=0;i<keys.length;i++){if(exts[keys[i]][0]===1/0||exts[keys[i]][1]===-Infinity){exts[keys[i]]=[0,1]}}return exts}.bind(extentCalc);