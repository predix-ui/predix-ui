<html><head><script>(function(){"use strict";window.PxAppBehavior=window.PxAppBehavior||{};PxAppBehavior.AssetActivatable={properties:{active:{type:Object,notify:!0,value:function value(){return this.multiActivate?[]:null}},activeRoute:{type:Array,notify:!0,value:function value(){return this.multiActivate?[]:null}},activeMeta:{type:Object,notify:!0,readOnly:!0,value:null,computed:"_getActiveMeta(active.*)"}},created:function created(){this._lastActivation={source:null,reason:null,item:null}},observers:["_activeChanged(active.*)","_activeRouteChanged(activeRoute.*)"],listeners:{"px-app-asset-should-be-activated":"_assetActivatedByEvent","px-app-asset-should-be-deactivated":"_assetDeactivatedByEvent"},_multiActivate:!1,get multiActivate(){return this._multiActivate},set multiActivate(val){if(val!==this._multiActivate){this._multiActivate=val;this._toggleMultiActivate(val)}},_toggleMultiActivate:function _toggleMultiActivate(allowMultiActivate){if(allowMultiActivate&&!Array.isArray(this.active)){this.active=[];this.activeRoute=[]}if(!allowMultiActivate&&Array.isArray(this.active)){this.active=this.active.length?this.active[0]:null}},activate:function activate(item){var source=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"METHOD";if(!this.multiActivate&&null===item&&null!==this._lastActivation.item||this.multiActivate&&null===item&&this.active.length||this.multiActivate&&Array.isArray(item)&&!item.length&&this.active.length){this.deactivate(Array.isArray(this.active)?babelHelpers.toConsumableArray(this.active):this.active);return this.active}if(!item||!this.multiActivate&&item===this._lastActivation.item||this.multiActivate&&-1<this.active.indexOf(item))return this.active;if(this.multiActivate&&Array.isArray(item)&&item.length){for(var i=0;i<item.length;i++){this.activate(item[i],source)}return this.active}if(this._assetGraph.hasNode(item)){this._activateAsset(item,source);return this.active}else{throw new Error("The following item could not be found in the items graph:\n          ".concat(JSON.stringify(item)))}},deactivate:function deactivate(item){var source=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"METHOD";if(!this.multiActivate&&(!item||this.active===item)){this._deactivateAsset(this.active);return this.active}if(this.multiActivate&&!item){this.deactivate(babelHelpers.toConsumableArray(this.active));return this.active}if(this.multiActivate&&Array.isArray(item)&&this.active.length){for(var i=0;i<item.length;i++){this.deactivate(item[i],source)}return this.active}if(this.multiActivate&&item&&-1<this.active.indexOf(item)){this._deactivateAsset(item);return this.active}},_getActiveMeta:function _getActiveMeta(active){var _this=this;if(active.base&&!Array.isArray(active.base)&&this._assetGraph&&this._assetGraph.hasNode(active.base)){var _this$_assetGraph$get=this._assetGraph.getInfo(active.base,this.keys.id),path=_this$_assetGraph$get.path,route=_this$_assetGraph$get.route,parent=_this$_assetGraph$get.parent,children=_this$_assetGraph$get.children,siblings=_this$_assetGraph$get.siblings;return{item:active.base,path:path,route:route,parent:parent,children:children,siblings:siblings}}if(active.base&&Array.isArray(active.base)&&active.base.length){return active.base.map(function(item){var _this$_assetGraph$get2=_this._assetGraph.getInfo(item,_this.keys.id),path=_this$_assetGraph$get2.path,route=_this$_assetGraph$get2.route,parent=_this$_assetGraph$get2.parent,children=_this$_assetGraph$get2.children,siblings=_this$_assetGraph$get2.siblings;return{item:item,path:path,route:route,parent:parent,children:children,siblings:siblings}})}return{item:null,path:null,route:null,parent:null,children:null,siblings:null}},_assetActivatedByEvent:function _assetActivatedByEvent(evt){evt.stopPropagation();if(evt.detail.item){this.activate(evt.detail.item,"DOM_EVENT")}},_assetDeactivatedByEvent:function _assetDeactivatedByEvent(evt){evt.stopPropagation();if(evt.detail.item){this.deactivate(evt.detail.item,"DOM_EVENT")}},_activeRouteChanged:function _activeRouteChanged(ref){if(!ref||!ref.path||!this._assetGraph||this._squashActiveRouteChange)return;if(!this.multiActivate&&"activeRoute"===ref.path){this._updateActiveFromRoute(ref.base)}if(this.multiActivate&&("activeRoute"===ref.path||"activeRoute.splices"==ref.path)){this._updateActiveFromRouteMulti(ref.base)}},_updateActiveFromRoute:function _updateActiveFromRoute(route){if(!this.active&&(null===route||Array.isArray(route)&&!route.length)){return}if(this.active&&(null===route||Array.isArray(route)&&!route.length)){this._squashActiveChange=!0;this.deactivate(this.active,"ROUTE_CHANGED");this._squashActiveChange=!1;return}var item=this._assetGraph.getNodeAtRoute(route,this.keys.id);if(item===this.active){return}else if(item){this.activate(item,"ROUTE_CHANGED")}else{throw new Error("The route ".concat(JSON.stringify(route)," could not be found in the items graph."))}},_updateActiveFromRouteMulti:function _updateActiveFromRouteMulti(route){var _this2=this;if(this.active.length&&(null===route||Array.isArray(route)&&!route.length)){this._squashActiveChange=!0;this.deactivate(null,"ROUTE_CHANGED");this._squashActiveChange=!1;return}if(Array.isArray(route)){for(var i=0;i<route.length;i++){this._squashActiveChange=!0;this.active=route.map(function(route){var item=_this2._assetGraph.getNodeAtRoute(route,_this2.keys.id);if(!item){throw new Error("The following item could not be found in the items graph:\n                  ".concat(JSON.stringify(item)))}return item});this._squashActiveChange=!1}}},_activeChanged:function _activeChanged(ref){if(!ref||!ref.path||this._squashActiveChange)return;if(!this.multiActivate&&"active"===ref.path){this._updateActiveRoute(ref.base)}if(this.multiActivate&&("active"===ref.path||"active.splices"===ref.path)){this._updateActiveRouteMulti(ref.base)}},_updateActiveRoute:function _updateActiveRoute(active){if(active){if(!this._assetGraph.hasNode(active)){throw new Error("The following item could not be found in the items graph:\n              ".concat(JSON.stringify(active)));return}var route=this._assetGraph.getRoute(active,this.keys.id);if(this._routeIsDifferent(route,this.activeRoute)){this._squashActiveRouteChange=!0;this.activeRoute=route;this._squashActiveRouteChange=!1}}else{this._squashActiveRouteChange=!0;this.activeRoute=null;this._squashActiveRouteChange=!1}},_updateActiveRouteMulti:function _updateActiveRouteMulti(active){var _this3=this;if(active&&Array.isArray(active)&&active.length){this._squashActiveRouteChange=!0;this.activeRoute=active.map(function(item){if(!_this3._assetGraph.hasNode(item)){throw new Error("The following item could not be found in the items graph:\n                ".concat(JSON.stringify(item)))}return _this3._assetGraph.getRoute(item,_this3.keys.id)});this._squashActiveRouteChange=!1}else{this._squashActiveRouteChange=!0;this.activeRoute=[];this._squashActiveRouteChange=!1}},_routeIsDifferent:function _routeIsDifferent(r1,r2){if(!r1||!r2)return!0;if(r1.length!==r2.length)return!0;for(var i=0;i<r1.length;i++){if(r1[i]!==r2[i])return!0}return!1},_activateAsset:function _activateAsset(item,source){var _this$_assetGraph$get3=this._assetGraph.getInfo(item,this.keys.id),route=_this$_assetGraph$get3.route,path=_this$_assetGraph$get3.path;this._lastActivation={item:item,source:source,route:route};if(!this.multiActivate){this.active=item}if(this.multiActivate){this.push("active",item)}this.fire("px-app-asset-activated",{source:source,item:item,route:route,path:path})},_deactivateAsset:function _deactivateAsset(item,source){var _this$_assetGraph$get4=this._assetGraph.getInfo(item,this.keys.id),route=_this$_assetGraph$get4.route,path=_this$_assetGraph$get4.path;this._lastActivation={item:null,source:null,route:null};if(!this.multiActivate){this.set("active",null);this.fire("px-app-asset-deactivated",{source:source,item:item,route:route,path:path})}if(this.multiActivate){this.splice("active",this.active.indexOf(item),1);this.fire("px-app-asset-deactivated",{source:source,item:item,route:route,path:path})}}}})();</script>
</head><body></body></html>