<html><head><script>(function(){"use strict";window.PxAppBehavior=window.PxAppBehavior||{};PxAppBehavior.AssetSelectable={properties:{selected:{type:Object,notify:!0,value:function value(){return this.multiSelect?[]:null}},selectedRoute:{type:Array,notify:!0,value:function value(){return this.multiSelect?[]:null}},selectedMeta:{type:Object,notify:!0,readOnly:!0,value:null,computed:"_getSelectedMeta(selected.*)"}},created:function created(){this._lastSelection={source:null,reason:null,item:null}},observers:["_selectedChanged(selected.*)","_selectedRouteChanged(selectedRoute.*)"],listeners:{"px-app-asset-graph-created":"__selectInitialAssets","px-app-asset-should-be-selected":"_assetSelectedByEvent","px-app-asset-should-be-deselected":"_assetDeselectedByEvent"},_multiSelect:!1,get multiSelect(){return this._multiSelect},set multiSelect(val){if(val!==this._multiSelect){this._multiSelect=val;this._toggleMultiSelect(val)}},_toggleMultiSelect:function _toggleMultiSelect(allowMultiSelect){if(allowMultiSelect&&!Array.isArray(this.selected)){this.selected=[];this.selectedRoute=[]}if(!allowMultiSelect&&Array.isArray(this.selected)){this.selected=this.selected.length?this.selected[0]:null}},select:function select(item){var source=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"METHOD";if(!this.multiSelect&&null===item&&null!==this._lastSelection.item||this.multiSelect&&null===item&&this.selected.length||this.multiSelect&&Array.isArray(item)&&!item.length&&this.selected.length){this.deselect(Array.isArray(this.selected)?babelHelpers.toConsumableArray(this.selected):this.selected);return this.selected}if(!item||!this.multiSelect&&item===this._lastSelection.item||this.multiSelect&&-1<this.selected.indexOf(item))return this.selected;if(this.multiSelect&&Array.isArray(item)&&item.length){for(var i=0;i<item.length;i++){this.select(item[i],source)}return this.selected}if(this._assetGraph.hasNode(item)){this._selectAsset(item,source);return this.selected}else{throw new Error("The following item could not be found in the items graph:\n          ".concat(JSON.stringify(item)))}},deselect:function deselect(item){var source=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"METHOD";if(!this.multiSelect&&(!item||this.selected===item)){this._deselectAsset(this.selected);return this.selected}if(this.multiSelect&&!item){this.deselect(babelHelpers.toConsumableArray(this.selected));return this.selected}if(this.multiSelect&&Array.isArray(item)&&this.selected.length){for(var i=0;i<item.length;i++){this.deselect(item[i],source)}return this.selected}if(this.multiSelect&&item&&-1<this.selected.indexOf(item)){this._deselectAsset(item);return this.selected}},_getSelectedMeta:function _getSelectedMeta(selected){var _this=this;if(selected.base&&!Array.isArray(selected.base)&&this._assetGraph&&this._assetGraph.hasNode(selected.base)){var _this$_assetGraph$get=this._assetGraph.getInfo(selected.base,this.keys.id),path=_this$_assetGraph$get.path,route=_this$_assetGraph$get.route,parent=_this$_assetGraph$get.parent,children=_this$_assetGraph$get.children,siblings=_this$_assetGraph$get.siblings;return{item:selected.base,path:path,route:route,parent:parent,children:children,siblings:siblings}}if(selected.base&&Array.isArray(selected.base)&&selected.base.length){return selected.base.map(function(item){var _this$_assetGraph$get2=_this._assetGraph.getInfo(item,_this.keys.id),path=_this$_assetGraph$get2.path,route=_this$_assetGraph$get2.route,parent=_this$_assetGraph$get2.parent,children=_this$_assetGraph$get2.children,siblings=_this$_assetGraph$get2.siblings;return{item:item,path:path,route:route,parent:parent,children:children,siblings:siblings}})}return{item:null,path:null,route:null,parent:null,children:null,siblings:null}},_assetSelectedByEvent:function _assetSelectedByEvent(evt){evt.stopPropagation();if(evt.detail.item){this.select(evt.detail.item,"DOM_EVENT")}},_assetDeselectedByEvent:function _assetDeselectedByEvent(evt){evt.stopPropagation();if(evt.detail.item){this.deselect(evt.detail.item,"DOM_EVENT")}},_selectedRouteChanged:function _selectedRouteChanged(ref){if(!ref||!ref.path||!this._assetGraph||this._squashSelectedRouteChange)return;if(!this.multiSelect&&"selectedRoute"===ref.path){this._updateSelectedFromRoute(ref.base)}if(this.multiSelect&&("selectedRoute"===ref.path||"selectedRoute.splices"==ref.path)){this._updateSelectedFromRouteMulti(ref.base)}},_updateSelectedFromRoute:function _updateSelectedFromRoute(route){if(!this.selected&&(null===route||Array.isArray(route)&&!route.length)){return}if(this.selected&&(null===route||Array.isArray(route)&&!route.length)){this._squashSelectedChange=!0;this.deselect(this.selected,"ROUTE_CHANGED");this._squashSelectedChange=!1;return}var item=this._assetGraph.getNodeAtRoute(route,this.keys.id);if(item===this.selected){return}else if(item){this.select(item,"ROUTE_CHANGED")}else{throw new Error("The route ".concat(JSON.stringify(route)," could not be found in the items graph."))}},_updateSelectedFromRouteMulti:function _updateSelectedFromRouteMulti(route){var _this2=this;if(this.selected.length&&(null===route||Array.isArray(route)&&!route.length)){this._squashSelectedChange=!0;this.deselect(null,"ROUTE_CHANGED");this._squashSelectedChange=!1;return}if(Array.isArray(route)){for(var i=0;i<route.length;i++){this._squashSelectedChange=!0;this.selected=route.map(function(route){var item=_this2._assetGraph.getNodeAtRoute(route,_this2.keys.id);if(!item){throw new Error("The following item could not be found in the items graph:\n                  ".concat(JSON.stringify(item)))}return item});this._squashSelectedChange=!1}}},_selectedChanged:function _selectedChanged(ref){if(!ref||!ref.path||this._squashSelectedChange||!this._assetGraph)return;if(!this.multiSelect&&"selected"===ref.path&&"undefined"!==typeof this.selectedRoute){this._updateSelectedRoute(ref.base)}if(this.multiSelect&&("selected"===ref.path||"selected.splices"===ref.path)&&"undefined"!==typeof this.selectedRoute){this._updateSelectedRouteMulti(ref.base)}},_checkIfEmpty:function _checkIfEmpty(item){if(Array.isArray(item))return!!item.length;return!!item},_updateSelectedRoute:function _updateSelectedRoute(selected){if(this._checkIfEmpty(selected)){if(!this._assetGraph.hasNode(selected)){throw new Error("The following item could not be found in the items graph:\n              ".concat(JSON.stringify(selected)));return}var route=this._assetGraph.getRoute(selected,this.keys.id);if(this._routeIsDifferent(route,this.selectedRoute)){this._squashSelectedRouteChange=!0;this.selectedRoute=route;this._squashSelectedRouteChange=!1}}else{this._squashSelectedRouteChange=!0;this.selectedRoute=null;this._squashSelectedRouteChange=!1}},_updateSelectedRouteMulti:function _updateSelectedRouteMulti(selected){var _this3=this;if(selected&&Array.isArray(selected)&&selected.length){this._squashSelectedRouteChange=!0;this.selectedRoute=selected.map(function(item){if(!_this3._assetGraph.hasNode(item)){throw new Error("The following item could not be found in the items graph:\n                ".concat(JSON.stringify(item)))}return _this3._assetGraph.getRoute(item,_this3.keys.id)});this._squashSelectedRouteChange=!1}else{this._squashSelectedRouteChange=!0;this.selectedRoute=[];this._squashSelectedRouteChange=!1}},__selectInitialAssets:function __selectInitialAssets(){if(!this.multiSelect&&this.selected&&!this.selectedRoute){this._updateSelectedRoute(this.selected)}else if(!this.multiSelect&&!this.selected&&this.selectedRoute){this._updateSelectedFromRoute(this.selectedRoute)}else if(this.multiSelect&&!!this.selected&&this.selected.length&&!this.selectedRoute.length){this._updateSelectedRouteMulti(this.selected)}else if(this.multiSelect&&!!this.selected&&!this.selected.length&&this.selectedRoute.length){this._updateSelectedFromRouteMulti(this.selected)}},_routeIsDifferent:function _routeIsDifferent(r1,r2){if(!r1||!r2)return!0;if(r1.length!==r2.length)return!0;for(var i=0;i<r1.length;i++){if(r1[i]!==r2[i])return!0}return!1},_selectAsset:function _selectAsset(item,source){var _this$_assetGraph$get3=this._assetGraph.getInfo(item,this.keys.id),route=_this$_assetGraph$get3.route,path=_this$_assetGraph$get3.path;this._lastSelection={item:item,source:source,route:route};if(!this.multiSelect){this.selected=item}if(this.multiSelect){this.push("selected",item)}this.fire("px-app-asset-selected",{source:source,item:item,route:route,path:path})},_deselectAsset:function _deselectAsset(item,source){var _this$_assetGraph$get4=this._assetGraph.getInfo(item,this.keys.id),route=_this$_assetGraph$get4.route,path=_this$_assetGraph$get4.path;this._lastSelection={item:null,source:null,route:null};if(!this.multiSelect){this.set("selected",null);this.fire("px-app-asset-deselected",{source:source,item:item,route:route,path:path})}if(this.multiSelect){this.splice("selected",this.selected.indexOf(item),1);this.fire("px-app-asset-deselected",{source:source,item:item,route:route,path:path})}}}})();</script>
</head><body></body></html>